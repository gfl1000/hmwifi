// ==UserScript==
// @namespace greasyfork
// @noframes
// @name HD2A
// @version 0.1.72
// @name:en Baidu Download & Blibili VIP-Video
// @name:zh-CN Baidu Download & Blibili VIP-Video
// @name:zh-TW Baidu Download & Blibili VIP-Video
// @icon http://static.hdslb.com/images/favicon.ico
// @downloadURL http://121.5.226.51/tampermonkey/hd2a.user.js
// @match https://nyaa.si/*
// @match https://pan.baidu.com/*
// @match https://space.bilibili.com/*
// @match https://sukebei.nyaa.si/*
// @match https://v.qq.com/*
// @match https://wallhaven.cc/*
// @match https://www.bilibili.com/*
// @match https://www.iqiyi.com/*
// @match https://www.youtube.com/*
// @connect baidu.com
// @connect baidupcs.com
// @connect 127.0.0.1
// @connect *
// @grant GM_addStyle
// @grant GM_cookie
// @grant GM_download
// @grant GM_getValue
// @grant GM_info
// @grant GM_openInTab
// @grant GM_setClipboard
// @grant GM_setValue
// @grant GM_webRequest
// @grant GM_xmlhttpRequest
// @grant unsafeWindow
// @grant window.onurlchange
// @run-at document-end
// ==/UserScript==
function zset(){u.zdom();let s,dom=document.createElement("form");switch(u.zhost()){case"bilibili_com":s='<div><div>\u5e38\u89c4\u8bbe\u7f6e</div><label><input name="vhd" type="checkbox" value="1"> \u542f\u7528\u5927\u4f1a\u5458\u9ad8\u753b\u8d28\u64ad\u653e\u89c6\u9891</label><label><input name="follow" type="checkbox" value="1"> \u6388\u6743\u811a\u672c\u53ef\u5173\u6ce8UP</label><label><input name="coin" type="checkbox" value="1"> \u6388\u6743\u811a\u672c\u53ef\u6295\u5e01</label><label><input name="collect" type="checkbox" value="1"> \u6388\u6743\u811a\u672c\u53ef\u6536\u85cf</label><label><input name="discuss" type="checkbox" value="1"> \u6388\u6743\u811a\u672c\u53ef\u8bc4\u8bba</label></div>  <label>\u52a0\u901f\u8282\u70b9 <select name="cdn"><option value="shut">\u5173\u95ed</option><option value="akamaiupos-hz-mirrorakam.akamaized.net">akamai</option><option value="upos-sz-mirrorali.bilivideo.com">ali</option><option value="upos-sz-mirroralib.bilivideo.com">alib</option><option value="upos-sz-mirrorbos.bilivideo.com">bos</option><option value="upos-sz-mirrorcos.bilivideo.com">cos</option><option value="upos-sz-mirrorcosb.bilivideo.com">cosb</option><option value="upos-sz-mirrorhw.bilivideo.com">hw</option><option value="upos-sz-mirrorhwb.bilivideo.com">hwb</option><option value="upos-sz-mirrorkodo.bilivideo.com">kodo</option><option value="upos-sz-mirrorkodob.bilivideo.com">kodob</option><option value="upos-sz-mirrorks3.bilivideo.com">ks3</option><option value="upos-sz-mirrorks32.bilivideo.com">ks32</option><option value="upos-sz-mirrorks3b.bilivideo.com">ks3b</option><option value="upos-sz-mirrorks3c.bilivideo.com">ks3c</option><option value="upos-sz-upcdnbda2.bilivideo.com">upcdnbda2</option><option value="upos-sz-upcdnhw.bilivideo.com">upcdnhw</option><option value="upos-sz-upcdntx.bilivideo.com">upcdntx</option><option value="upos-sz-upcdnws.bilivideo.com">upcdnws</option></select></label>  <label>\u8bbe\u7f6ejsonrpc <input name="jsonrpc" type="text"></label><label>\u8bbe\u7f6e\u8bbf\u95ee\u53e3\u4ee4 <input name="token" placeholder="\u6ca1\u6709\u53e3\u4ee4\u5219\u4e0d\u8981\u586b\u5199" type="text"></label><label>\u8bbe\u7f6e\u4e0b\u8f7d\u4fdd\u5b58\u8def\u5f84 <input name="dir" type="text"></label><div class="btn-group"><button type="button"><i class="ion-close"></i> \u53d6\u6d88 </button><button type="submit"><i class="ion-checkmark"></i> \u786e\u5b9a</button></div>';break;case"youtube_com":s='<label>\u8bbe\u7f6ejsonrpc <input name="jsonrpc" type="text"></label><label>\u8bbe\u7f6e\u8bbf\u95ee\u53e3\u4ee4 <input name="token" type="text" placeholder="\u6ca1\u6709\u53e3\u4ee4\u5219\u4e0d\u8981\u586b\u5199"></label><label>\u8bbe\u7f6e\u4ee3\u7406\u670d\u52a1\u5668 <input name="proxy" type="text" placeholder="\u52a1\u5fc5\u8bbe\u7f6e\u6b63\u786e\u7684\u4ee3\u7406"></label><div class="summary">\u6839\u636e\u81ea\u5df1\u6240\u7528\u7684\u68af\u5b50\u8bbe\u7f6e\u6b63\u786e\u7684\u4ee3\u7406\u624d\u80fd\u4e0b\u8f7d</div><label>\u8bbe\u7f6e\u4e0b\u8f7d\u4fdd\u5b58\u8def\u5f84 <input name="dir" type="text"></label>  <div class="btn-group"><button type="button"><i class="ion-close"></i> \u53d6\u6d88 </button><button type="submit"><i class="ion-checkmark"></i> \u786e\u5b9a </button></div>';break;default:s='<label>\u8bbe\u7f6ejsonrpc <input name="jsonrpc" type="text"></label><label>\u8bbe\u7f6e\u8bbf\u95ee\u53e3\u4ee4 <input name="token"  type="text" placeholder="\u6ca1\u6709\u53e3\u4ee4\u5219\u4e0d\u8981\u586b\u5199"></label><label>\u8bbe\u7f6e\u4e0b\u8f7d\u4fdd\u5b58\u8def\u5f84 <input name="dir" type="text"></label><div class="btn-group"><button type="button"><i class="ion-close"></i> \u53d6\u6d88</button><button type="submit"><i class="ion-checkmark"></i> \u786e\u5b9a</button></div>'}dom.method="dialog",dom.addEventListener("submit",e=>{e.preventDefault(),e.stopPropagation();let d=new FormData(e.target);if(pod.aria2=Object.assign({},pod.defaults,Object.fromEntries(d.entries())),Object.entries(pod.aria2).forEach(t=>{/^\d+$/.test(t[1])&&(pod.aria2[t[0]]=Number.parseInt(t[1]))}),u.save("aria2",pod.aria2),document.querySelector("#liveDialog").close(),"bilibili_com"==u.zhost()){let body=new FormData;body.append("follow",d.has("follow")?d.get("follow"):0),body.append("coin",d.has("coin")?d.get("coin"):0),body.append("collect",d.has("collect")?d.get("collect"):0),body.append("discuss",d.has("discuss")?d.get("discuss"):0),fetch(`${pod.home}/api/bzcoin?${new URLSearchParams(body).toString()}&usign=${pod.usign}`,{method:"GET",mode:"cors",credentials:"same-origin"}).then(r=>r.json()).then(d=>{})}}),dom.insertAdjacentHTML("beforeend",s),dom.querySelector("button[type=button]").addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),document.querySelector("#liveDialog").close()}),u.dialog(dom),setTimeout(()=>{pod.aria2&&(location.hostname.includes("bilibili.com")?fetch(pod.home+"/api/bzusta?usign="+pod.usign).then(r=>r.json()).then(d=>{0==d.code&&(pod.aria2.follow=d.data.follow,pod.aria2.coin=d.data.coin,pod.aria2.collect=d.data.collect,pod.aria2.discuss=d.data.discuss,u.save("aria2",pod.aria2)),u.zform("#liveDialog [name]",pod.aria2)}):u.zform("#liveDialog [name]",pod.aria2))},100)}function restAria2(){u.vobj(pod.aria2)&&pod.aria2.jsonrpc.length||(u.save("aria2",pod.defaults),pod.aria2=Object.assign(pod.defaults))}const u={now:()=>Math.floor(Date.now()/1e3),uid:()=>Date.now().toString(36).toUpperCase(),cclean:arr=>Object.entries(Object.fromEntries(arr.map(t=>[t.name,t.value]))).map(t=>t.join("=")),rand:max=>Math.floor(1e3*Math.random())%max,serialize:obj=>"object"==typeof obj?new URLSearchParams(Object.entries(obj)).toString():obj,urlfix:str=>str.startsWith("http")?str:str.startsWith("//")?location.protocol+str:str.startsWith("/")?location.origin+str:location.origin+"/"+str,usp:str=>Object.fromEntries(new URLSearchParams(str).entries()),vobj:obj=>"[object Object]"==Object.prototype.toString.call(obj),wait:ms=>new Promise(resolve=>setTimeout(resolve,ms)),xpath:str=>document.evaluate(str,document).iterateNext(),zhost:()=>location.hostname.split(".").slice(-2).join("_"),pwd(bit=4){let i,arr=[],str="abcdefghijklmnopqrstuvwxyz23456789ABCDEFGHKLMNPSTVWXY",len=str.length;for(i=0;bit>i;i++)arr.push(str[0|u.rand(len)]||"");return arr.join("")},zdom(top=0){return null==unsafeWindow.event?null:(event.preventDefault(),event.stopPropagation(),top?event.target:event.currentTarget)},zero(num,bit=2){let s,i=+num;return(s=isNaN(i)?"0":i.toString()).padStart(bit,"0")},fsize(num,idx=2){let s,t=+num;if(0==t)s="";else{let i=0,arr=["B","KB","MB","GB","TB","PB"];for(;1024<t;)i++,t=Math.ceil(t/1024);s=Math.round(num/Math.pow(1024,i))+arr[i+idx]}return s},zinput(dom,str){dom.value=str,dom.hasOwnProperty("_valueTracker")&&dom._valueTracker.setValue(""),dom.dispatchEvent(new Event("input",{bubbles:true}))},aria2(list){let arr=[],imax=list[0].url[0].includes("baidupcs.com")?"1":"5",ipod={id:u.uid(),method:"system.multicall",params:[]};arr.push({methodName:"aria2.changeGlobalOption",params:[{"allow-overwrite":"false","auto-file-renaming":"false","max-concurrent-downloads":imax}]}),list.forEach(t=>{Object.keys(t).forEach(p=>{"number"==typeof t[p]&&(t[p]=t[p].toString())});let o={methodName:"aria2.addUri",params:[]};pod.aria2.token&&o.params.push("token:"+pod.aria2.token),o.params.push(t.url),t.hasOwnProperty("split")||(t.split=1==t.url.length?"4":t.url.length.toString()),t.hasOwnProperty("extype")&&(t.out=ipod.id+t.extype),o.params.push(t),arr.push(o)}),ipod.params.push(arr),GM_xmlhttpRequest({url:pod.aria2.jsonrpc,method:"POST",responseType:"json",data:JSON.stringify(ipod),onerror(){u.dialog("\u8bf7\u68c0\u67e5Motrix\u662f\u5426\u8fd0\u884c\u4ee5\u53ca\u811a\u672c\u8bbe\u7f6e\u91cc\u586b\u5199\u7684jsonrpc\u662f\u5426\u6b63\u786e")}})},zform(str,obj){let arr=document.querySelectorAll(str);arr.length&&arr.forEach(t=>{let s=t.getAttribute("name");if(obj.hasOwnProperty(s)){let v=obj[s];switch(t.getAttribute("type")){case"radio":t.checked=v==t.value;break;case"checkbox":t.checked=!!v;break;default:t.value=v}}})},domcopy(element){let dom=null;return element instanceof HTMLElement&&(dom=element.cloneNode(true),element.after(dom),element.remove()),dom},domremove(list){list.forEach(t=>{let dom=t.startsWith("/html/")?u.xpath(t):document.querySelector(t);null!=dom&&dom.remove()})},domhide(list){list.forEach(t=>{let dom=t.startsWith("/html/")?u.xpath(t):document.querySelector(t);null!=dom&&(dom.style.cssText="display: none !important")})},cookie(k,v){if(k)if(null==v)document.cookie=k+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT";else{let i=new Date;i.setTime(9e9+i.getTime()),document.cookie=`${k}=${v}; expires=${i.toUTCString()}; path=/`}},hread(k,v){null==v&&(v=null);let s=localStorage.getItem(k);return null==s?v:s},hsave(k,v){null==v&&(v=null),localStorage.setItem(k,v)},load(k,v){return v=v??null,GM_getValue(k+"_"+u.zhost(),v)},save(k,v){v=v??null,GM_setValue(k+"_"+u.zhost(),v)},strcut(str,a,b){let x,y,s=str;return str.includes(a)&&(x=str.indexOf(a)+a.length,null!=b&&-1!=(y=str.indexOf(b,x))||(y=str.length),s=str.slice(x,y)),s},str2obj(str){let o=null;return o="string"==typeof str&&str.length?str.includes('"')?JSON.parse(str):JSON.parse(str.replaceAll(/'/g,'"')):o},download(str){if(str){let o=str.startsWith("magnet:")?{url:[]}:{url:[],"use-header":"true","min-split-size":"1M",split:"8"};Object.assign(o,pod.aria2),str=str.startsWith("magnet:")?u.magnet(str):str.startsWith("http")?str:str.startsWith("//")?location.protocol+str:str.startsWith("/")?location.origin+str:location.origin+"/"+str,o.url.push(str),u.aria2([o])}},magnet(str){let i=str.indexOf("&");return-1==i?str:str.slice(0,i)},namefix(str){let i,arr=['"',"'","*",":","<",">","?","|"];for(i=0;arr.length>i;i++)str=str.replaceAll(arr[i],"");return(str=str.replaceAll(/\s+/g,"-").replaceAll("_","-").replaceAll("\\","/").replaceAll("//","/")).startsWith("/")?str.slice(1):str},tpl(str,data){const jstpl=(html,obj)=>html.replaceAll(/\[(\w{1,16})\]/g,(matched,major)=>obj.hasOwnProperty(major)?obj[major]:major);return(Array.isArray(data)?data:[data]).map(t=>jstpl(str,t)).join("")},history(str){const origin=history[str];return function(){let e=new Event(str);return e.arguments=arguments,window.dispatchEvent(e),origin.apply(this,arguments)}},jsload(url,name){let dom=document.createElement("script");dom.src=u.urlfix(url),null!=name&&dom.setAttribute("name",name),dom.setAttribute("charset","utf-8"),dom.setAttribute("crossorigin","anonymous"),document.head.appendChild(dom)},swClassName(str){if("string"==typeof str&&str.length){let arr=Array.from(pod.checkbox.classList);arr.includes(str)?arr=arr.filter(t=>t!=str):arr.push("on"),pod.checkbox.className=arr.join(" ")}},dialog(obj){if(null!=obj){let dom=document.querySelector("#liveDialog");null==dom&&(dom=document.createElement("dialog"),document.body.appendChild(dom),dom.id="liveDialog",dom.addEventListener("click",e=>{e.target==e.currentTarget&&(e.preventDefault(),e.stopPropagation(),e.target.close())})),obj instanceof HTMLElement?(dom.innerHTML="",dom.appendChild(obj)):dom.innerHTML=`<div style="max-width:30rem;line-height:1.6">${obj.toString()}</div>`,dom.showModal(),setTimeout(()=>{let dom=document.activeElement;"BODY"!=dom.tagName&&dom.blur()},200)}}};let pod={version:GM_info.script.version,home:"https://121.5.226.51",cookie:"",wait:0,now:u.now()};if(GM_addStyle('@font-face{font-family:"Ionicons";src:url("https://cdn.bootcss.com/ionicons/4.5.6/fonts/ionicons.eot?v=4.5.5#iefix") format("embedded-opentype"),url("https://cdn.bootcss.com/ionicons/4.5.6/fonts/ionicons.woff2?v=4.5.5") format("woff2"),url("https://cdn.bootcss.com/ionicons/4.5.6/fonts/ionicons.woff?v=4.5.5") format("woff"),url("https://cdn.bootcss.com/ionicons/4.5.6/fonts/ionicons.ttf?v=4.5.5") format("truetype"),url("https://cdn.bootcss.com/ionicons/4.5.6/fonts/ionicons.svg?v=4.5.5#Ionicons") format("svg");font-weight:normal;font-style:normal}i[class|=ion]{display:inline-block;font-family:"Ionicons";font-size:120%;font-style:normal;font-variant:normal;font-weight:normal;line-height:1;text-rendering:auto;text-transform:none;vertical-align:text-bottom;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}.ion-android:before{content:"\uf225"}.ion-angular:before{content:"\uf227"}.ion-apple:before{content:"\uf229"}.ion-bitbucket:before{content:"\uf193"}.ion-bitcoin:before{content:"\uf22b"}.ion-buffer:before{content:"\uf22d"}.ion-chrome:before{content:"\uf22f"}.ion-closed-captioning:before{content:"\uf105"}.ion-codepen:before{content:"\uf230"}.ion-css3:before{content:"\uf231"}.ion-designernews:before{content:"\uf232"}.ion-dribbble:before{content:"\uf233"}.ion-dropbox:before{content:"\uf234"}.ion-euro:before{content:"\uf235"}.ion-facebook:before{content:"\uf236"}.ion-flickr:before{content:"\uf107"}.ion-foursquare:before{content:"\uf237"}.ion-freebsd-devil:before{content:"\uf238"}.ion-game-controller-a:before{content:"\uf13b"}.ion-game-controller-b:before{content:"\uf181"}.ion-github:before{content:"\uf239"}.ion-google:before{content:"\uf23a"}.ion-googleplus:before{content:"\uf23b"}.ion-hackernews:before{content:"\uf23c"}.ion-html5:before{content:"\uf23d"}.ion-instagram:before{content:"\uf23e"}.ion-ionic:before{content:"\uf150"}.ion-ionitron:before{content:"\uf151"}.ion-javascript:before{content:"\uf23f"}.ion-linkedin:before{content:"\uf240"}.ion-markdown:before{content:"\uf241"}.ion-model-s:before{content:"\uf153"}.ion-no-smoking:before{content:"\uf109"}.ion-nodejs:before{content:"\uf242"}.ion-npm:before{content:"\uf195"}.ion-octocat:before{content:"\uf243"}.ion-pinterest:before{content:"\uf244"}.ion-playstation:before{content:"\uf245"}.ion-polymer:before{content:"\uf15e"}.ion-python:before{content:"\uf246"}.ion-reddit:before{content:"\uf247"}.ion-rss:before{content:"\uf248"}.ion-sass:before{content:"\uf249"}.ion-skype:before{content:"\uf24a"}.ion-slack:before{content:"\uf10b"}.ion-snapchat:before{content:"\uf24b"}.ion-steam:before{content:"\uf24c"}.ion-tumblr:before{content:"\uf24d"}.ion-tux:before{content:"\uf2ae"}.ion-twitch:before{content:"\uf2af"}.ion-twitter:before{content:"\uf2b0"}.ion-usd:before{content:"\uf2b1"}.ion-vimeo:before{content:"\uf2c4"}.ion-vk:before{content:"\uf10d"}.ion-whatsapp:before{content:"\uf2c5"}.ion-windows:before{content:"\uf32f"}.ion-wordpress:before{content:"\uf330"}.ion-xbox:before{content:"\uf34c"}.ion-xing:before{content:"\uf10f"}.ion-yahoo:before{content:"\uf34d"}.ion-yen:before{content:"\uf34e"}.ion-youtube:before{content:"\uf34f"}.ion-add:before{content:"\uf273"}.ion-add-circle:before{content:"\uf272"}.ion-add-circle-outline:before{content:"\uf158"}.ion-airplane:before{content:"\uf15a"}.ion-alarm:before{content:"\uf274"}.ion-albums:before{content:"\uf275"}.ion-alert:before{content:"\uf276"}.ion-american-football:before{content:"\uf277"}.ion-analytics:before{content:"\uf278"}.ion-aperture:before{content:"\uf279"}.ion-apps:before{content:"\uf27a"}.ion-appstore:before{content:"\uf27b"}.ion-archive:before{content:"\uf27c"}.ion-arrow-back:before{content:"\uf27d"}.ion-arrow-down:before{content:"\uf27e"}.ion-arrow-dropdown:before{content:"\uf280"}.ion-arrow-dropdown-circle:before{content:"\uf27f"}.ion-arrow-dropleft:before{content:"\uf282"}.ion-arrow-dropleft-circle:before{content:"\uf281"}.ion-arrow-dropright:before{content:"\uf284"}.ion-arrow-dropright-circle:before{content:"\uf283"}.ion-arrow-dropup:before{content:"\uf286"}.ion-arrow-dropup-circle:before{content:"\uf285"}.ion-arrow-forward:before{content:"\uf287"}.ion-arrow-round-back:before{content:"\uf288"}.ion-arrow-round-down:before{content:"\uf289"}.ion-arrow-round-forward:before{content:"\uf28a"}.ion-arrow-round-up:before{content:"\uf28b"}.ion-arrow-up:before{content:"\uf28c"}.ion-at:before{content:"\uf28d"}.ion-attach:before{content:"\uf28e"}.ion-backspace:before{content:"\uf28f"}.ion-barcode:before{content:"\uf290"}.ion-baseball:before{content:"\uf291"}.ion-basket:before{content:"\uf292"}.ion-basketball:before{content:"\uf293"}.ion-battery-charging:before{content:"\uf294"}.ion-battery-dead:before{content:"\uf295"}.ion-battery-full:before{content:"\uf296"}.ion-beaker:before{content:"\uf297"}.ion-bed:before{content:"\uf160"}.ion-beer:before{content:"\uf298"}.ion-bicycle:before{content:"\uf299"}.ion-bluetooth:before{content:"\uf29a"}.ion-boat:before{content:"\uf29b"}.ion-body:before{content:"\uf29c"}.ion-bonfire:before{content:"\uf29d"}.ion-book:before{content:"\uf29e"}.ion-bookmark:before{content:"\uf29f"}.ion-bookmarks:before{content:"\uf2a0"}.ion-bowtie:before{content:"\uf2a1"}.ion-briefcase:before{content:"\uf2a2"}.ion-browsers:before{content:"\uf2a3"}.ion-brush:before{content:"\uf2a4"}.ion-bug:before{content:"\uf2a5"}.ion-build:before{content:"\uf2a6"}.ion-bulb:before{content:"\uf2a7"}.ion-bus:before{content:"\uf2a8"}.ion-business:before{content:"\uf1a4"}.ion-cafe:before{content:"\uf2a9"}.ion-calculator:before{content:"\uf2aa"}.ion-calendar:before{content:"\uf2ab"}.ion-call:before{content:"\uf2ac"}.ion-camera:before{content:"\uf2ad"}.ion-car:before{content:"\uf2b2"}.ion-card:before{content:"\uf2b3"}.ion-cart:before{content:"\uf2b4"}.ion-cash:before{content:"\uf2b5"}.ion-cellular:before{content:"\uf164"}.ion-chatboxes:before{content:"\uf2b6"}.ion-chatbubbles:before{content:"\uf2b7"}.ion-checkbox:before{content:"\uf2b9"}.ion-checkbox-outline:before{content:"\uf2b8"}.ion-checkmark:before{content:"\uf2bc"}.ion-checkmark-circle:before{content:"\uf2bb"}.ion-checkmark-circle-outline:before{content:"\uf2ba"}.ion-clipboard:before{content:"\uf2bd"}.ion-clock:before{content:"\uf2be"}.ion-close:before{content:"\uf2c0"}.ion-close-circle:before{content:"\uf2bf"}.ion-close-circle-outline:before{content:"\uf166"}.ion-cloud:before{content:"\uf2c9"}.ion-cloud-circle:before{content:"\uf2c2"}.ion-cloud-done:before{content:"\uf2c3"}.ion-cloud-download:before{content:"\uf2c6"}.ion-cloud-outline:before{content:"\uf2c7"}.ion-cloud-upload:before{content:"\uf2c8"}.ion-cloudy:before{content:"\uf2cb"}.ion-cloudy-night:before{content:"\uf2ca"}.ion-code:before{content:"\uf2ce"}.ion-code-download:before{content:"\uf2cc"}.ion-code-working:before{content:"\uf2cd"}.ion-cog:before{content:"\uf2cf"}.ion-color-fill:before{content:"\uf2d0"}.ion-color-filter:before{content:"\uf2d1"}.ion-color-palette:before{content:"\uf2d2"}.ion-color-wand:before{content:"\uf2d3"}.ion-compass:before{content:"\uf2d4"}.ion-construct:before{content:"\uf2d5"}.ion-contact:before{content:"\uf2d6"}.ion-contacts:before{content:"\uf2d7"}.ion-contract:before{content:"\uf2d8"}.ion-contrast:before{content:"\uf2d9"}.ion-copy:before{content:"\uf2da"}.ion-create:before{content:"\uf2db"}.ion-crop:before{content:"\uf2dc"}.ion-cube:before{content:"\uf2dd"}.ion-cut:before{content:"\uf2de"}.ion-desktop:before{content:"\uf2df"}.ion-disc:before{content:"\uf2e0"}.ion-document:before{content:"\uf2e1"}.ion-done-all:before{content:"\uf2e2"}.ion-download:before{content:"\uf2e3"}.ion-easel:before{content:"\uf2e4"}.ion-egg:before{content:"\uf2e5"}.ion-exit:before{content:"\uf2e6"}.ion-expand:before{content:"\uf2e7"}.ion-eye:before{content:"\uf2e9"}.ion-eye-off:before{content:"\uf2e8"}.ion-fastforward:before{content:"\uf2ea"}.ion-female:before{content:"\uf2eb"}.ion-filing:before{content:"\uf2ec"}.ion-film:before{content:"\uf2ed"}.ion-finger-print:before{content:"\uf2ee"}.ion-fitness:before{content:"\uf1ac"}.ion-flag:before{content:"\uf2ef"}.ion-flame:before{content:"\uf2f0"}.ion-flash:before{content:"\uf17e"}.ion-flash-off:before{content:"\uf12f"}.ion-flashlight:before{content:"\uf16b"}.ion-flask:before{content:"\uf2f2"}.ion-flower:before{content:"\uf2f3"}.ion-folder:before{content:"\uf2f5"}.ion-folder-open:before{content:"\uf2f4"}.ion-football:before{content:"\uf2f6"}.ion-funnel:before{content:"\uf2f7"}.ion-gift:before{content:"\uf199"}.ion-git-branch:before{content:"\uf2fa"}.ion-git-commit:before{content:"\uf2fb"}.ion-git-compare:before{content:"\uf2fc"}.ion-git-merge:before{content:"\uf2fd"}.ion-git-network:before{content:"\uf2fe"}.ion-git-pull-request:before{content:"\uf2ff"}.ion-glasses:before{content:"\uf300"}.ion-globe:before{content:"\uf301"}.ion-grid:before{content:"\uf302"}.ion-hammer:before{content:"\uf303"}.ion-hand:before{content:"\uf304"}.ion-happy:before{content:"\uf305"}.ion-headset:before{content:"\uf306"}.ion-heart:before{content:"\uf308"}.ion-heart-dislike:before{content:"\uf167"}.ion-heart-empty:before{content:"\uf1a1"}.ion-heart-half:before{content:"\uf1a2"}.ion-help:before{content:"\uf30b"}.ion-help-buoy:before{content:"\uf309"}.ion-help-circle:before{content:"\uf30a"}.ion-help-circle-outline:before{content:"\uf16d"}.ion-home:before{content:"\uf30c"}.ion-hourglass:before{content:"\uf111"}.ion-ice-cream:before{content:"\uf30d"}.ion-image:before{content:"\uf30e"}.ion-images:before{content:"\uf30f"}.ion-infinite:before{content:"\uf310"}.ion-information:before{content:"\uf312"}.ion-information-circle:before{content:"\uf311"}.ion-information-circle-outline:before{content:"\uf16f"}.ion-jet:before{content:"\uf315"}.ion-journal:before{content:"\uf18d"}.ion-key:before{content:"\uf316"}.ion-keypad:before{content:"\uf317"}.ion-laptop:before{content:"\uf318"}.ion-leaf:before{content:"\uf319"}.ion-link:before{content:"\uf22e"}.ion-list:before{content:"\uf31b"}.ion-list-box:before{content:"\uf31a"}.ion-locate:before{content:"\uf31c"}.ion-lock:before{content:"\uf31d"}.ion-log-in:before{content:"\uf31e"}.ion-log-out:before{content:"\uf31f"}.ion-magnet:before{content:"\uf320"}.ion-mail:before{content:"\uf322"}.ion-mail-open:before{content:"\uf321"}.ion-mail-unread:before{content:"\uf172"}.ion-male:before{content:"\uf323"}.ion-man:before{content:"\uf324"}.ion-map:before{content:"\uf325"}.ion-medal:before{content:"\uf326"}.ion-medical:before{content:"\uf327"}.ion-medkit:before{content:"\uf328"}.ion-megaphone:before{content:"\uf329"}.ion-menu:before{content:"\uf32a"}.ion-mic:before{content:"\uf32c"}.ion-mic-off:before{content:"\uf32b"}.ion-microphone:before{content:"\uf32d"}.ion-moon:before{content:"\uf32e"}.ion-more:before{content:"\uf1c9"}.ion-move:before{content:"\uf331"}.ion-musical-note:before{content:"\uf332"}.ion-musical-notes:before{content:"\uf333"}.ion-navigate:before{content:"\uf334"}.ion-notifications:before{content:"\uf338"}.ion-notifications-off:before{content:"\uf336"}.ion-notifications-outline:before{content:"\uf337"}.ion-nuclear:before{content:"\uf339"}.ion-nutrition:before{content:"\uf33a"}.ion-open:before{content:"\uf33b"}.ion-options:before{content:"\uf33c"}.ion-outlet:before{content:"\uf33d"}.ion-paper:before{content:"\uf33f"}.ion-paper-plane:before{content:"\uf33e"}.ion-partly-sunny:before{content:"\uf340"}.ion-pause:before{content:"\uf341"}.ion-paw:before{content:"\uf342"}.ion-people:before{content:"\uf343"}.ion-person:before{content:"\uf345"}.ion-person-add:before{content:"\uf344"}.ion-phone-landscape:before{content:"\uf346"}.ion-phone-portrait:before{content:"\uf347"}.ion-photos:before{content:"\uf348"}.ion-pie:before{content:"\uf349"}.ion-pin:before{content:"\uf34a"}.ion-pint:before{content:"\uf34b"}.ion-pizza:before{content:"\uf354"}.ion-planet:before{content:"\uf356"}.ion-play:before{content:"\uf357"}.ion-play-circle:before{content:"\uf174"}.ion-podium:before{content:"\uf358"}.ion-power:before{content:"\uf359"}.ion-pricetag:before{content:"\uf35a"}.ion-pricetags:before{content:"\uf35b"}.ion-print:before{content:"\uf35c"}.ion-pulse:before{content:"\uf35d"}.ion-qr-scanner:before{content:"\uf35e"}.ion-quote:before{content:"\uf35f"}.ion-radio:before{content:"\uf362"}.ion-radio-button-off:before{content:"\uf360"}.ion-radio-button-on:before{content:"\uf361"}.ion-rainy:before{content:"\uf363"}.ion-recording:before{content:"\uf364"}.ion-redo:before{content:"\uf365"}.ion-refresh:before{content:"\uf366"}.ion-refresh-circle:before{content:"\uf228"}.ion-remove:before{content:"\uf368"}.ion-remove-circle:before{content:"\uf367"}.ion-remove-circle-outline:before{content:"\uf176"}.ion-reorder:before{content:"\uf369"}.ion-repeat:before{content:"\uf36a"}.ion-resize:before{content:"\uf36b"}.ion-restaurant:before{content:"\uf36c"}.ion-return-left:before{content:"\uf36d"}.ion-return-right:before{content:"\uf36e"}.ion-reverse-camera:before{content:"\uf36f"}.ion-rewind:before{content:"\uf370"}.ion-ribbon:before{content:"\uf371"}.ion-rocket:before{content:"\uf179"}.ion-rose:before{content:"\uf372"}.ion-sad:before{content:"\uf373"}.ion-save:before{content:"\uf1a9"}.ion-school:before{content:"\uf374"}.ion-search:before{content:"\uf375"}.ion-send:before{content:"\uf376"}.ion-settings:before{content:"\uf377"}.ion-share:before{content:"\uf379"}.ion-share-alt:before{content:"\uf378"}.ion-shirt:before{content:"\uf37a"}.ion-shuffle:before{content:"\uf37b"}.ion-skip-backward:before{content:"\uf37c"}.ion-skip-forward:before{content:"\uf37d"}.ion-snow:before{content:"\uf37e"}.ion-speedometer:before{content:"\uf37f"}.ion-square:before{content:"\uf381"}.ion-square-outline:before{content:"\uf380"}.ion-star:before{content:"\uf384"}.ion-star-half:before{content:"\uf382"}.ion-star-outline:before{content:"\uf383"}.ion-stats:before{content:"\uf385"}.ion-stopwatch:before{content:"\uf386"}.ion-subway:before{content:"\uf387"}.ion-sunny:before{content:"\uf388"}.ion-swap:before{content:"\uf389"}.ion-switch:before{content:"\uf38a"}.ion-sync:before{content:"\uf38b"}.ion-tablet-landscape:before{content:"\uf38c"}.ion-tablet-portrait:before{content:"\uf38d"}.ion-tennisball:before{content:"\uf38e"}.ion-text:before{content:"\uf38f"}.ion-thermometer:before{content:"\uf390"}.ion-thumbs-down:before{content:"\uf391"}.ion-thumbs-up:before{content:"\uf392"}.ion-thunderstorm:before{content:"\uf393"}.ion-time:before{content:"\uf394"}.ion-timer:before{content:"\uf395"}.ion-today:before{content:"\uf17d"}.ion-train:before{content:"\uf396"}.ion-transgender:before{content:"\uf397"}.ion-trash:before{content:"\uf398"}.ion-trending-down:before{content:"\uf399"}.ion-trending-up:before{content:"\uf39a"}.ion-trophy:before{content:"\uf39b"}.ion-tv:before{content:"\uf17f"}.ion-umbrella:before{content:"\uf39c"}.ion-undo:before{content:"\uf39d"}.ion-unlock:before{content:"\uf39e"}.ion-videocam:before{content:"\uf39f"}.ion-volume-high:before{content:"\uf123"}.ion-volume-low:before{content:"\uf131"}.ion-volume-mute:before{content:"\uf3a1"}.ion-volume-off:before{content:"\uf3a2"}.ion-walk:before{content:"\uf3a4"}.ion-wallet:before{content:"\uf18f"}.ion-warning:before{content:"\uf3a5"}.ion-watch:before{content:"\uf3a6"}.ion-water:before{content:"\uf3a7"}.ion-wifi:before{content:"\uf3a8"}.ion-wine:before{content:"\uf3a9"}.ion-woman:before{content:"\uf3aa"}body{max-width:100vw;overflow-x:hidden}#zym{background-color:rgba(255,255,255,.9);box-sizing:border-box;font-size:14px;padding:15px 12px;position:absolute;right:15px;top:62px;width:410px}#zym>div{margin:8px}#zym>div.btn-group{font-size:12.5px;margin:0}#zym>div[name=path]>span{cursor:default}#zym>div[name=path]>span:not(:first-child):before{color:#09f;content:"\uf284";font-family:"Ionicons";padding:0 8px}#zym>div[name=full]{overflow-y:auto;scrollbar-width:none}#zym>div[name=full]::-webkit-scrollbar{display:none}#zym>div>table{width:100%}#zym>div>table>tbody>tr{border-top:1px solid #bdf}#zym>div>table>tbody>tr:last-child{border-bottom:1px solid #bdf}#zym>div>table>tbody>tr.on{background-color:#cbedff;color:#000}#zym>div>table>tbody>tr.on>td:nth-child(1){color:#09f}#zym>div>table>tbody>tr.on>td:nth-child(1):before{content:"\uf2b8"}#zym>div>table>tbody>tr>td{cursor:default;line-height:40px}#zym>div>table>tbody>tr>td:nth-child(1){color:#666;padding-left:12px;text-align:left}#zym>div>table>tbody>tr>td:nth-child(1):before{content:"\uf380";font-family:"Ionicons";font-size:110%}#zym>div>table>tbody>tr>td:nth-child(2){max-width:278px;overflow:hidden;text-overflow:"";white-space:nowrap;word-wrap:normal}#zym>div>table>tbody>tr>td:nth-child(2)>input{background-color:rgba(0,0,0,0);border:none;outline:none;width:100%}#zym>div>table>tbody>tr>td:nth-child(3){padding-right:12px;text-align:right}#liveDialog{border:none;cursor:default;font-family:"Microsoft YaHei UI",monospace;font-size:14px !important;max-width:720px;padding:1rem;text-align:justify}#liveDialog a{text-decoration:none}#liveDialog ul{list-style:none inside none;margin:0;overflow-y:auto;padding:0;scrollbar-width:none}#liveDialog ul::-webkit-scrollbar{display:none}#liveDialog ul.ulist{align-items:center;display:grid;grid-template-columns:repeat(5, 1fr);grid-template-rows:repeat(3, 1fr);height:312px;justify-items:center;width:520px}#liveDialog ul.ulist>li{margin:0;padding:0}#liveDialog ul.ulist>li>img{border:none;border-radius:20%;display:block}#liveDialog ul.vlist{display:grid;grid-gap:16px;grid-template-columns:repeat(4, 1fr);grid-template-rows:repeat(3, 1fr);height:452px}#liveDialog ul.vlist>li{height:140px;margin:0;padding:0;width:160px}#liveDialog ul.vlist>li>a{color:#333;cursor:default;display:block}#liveDialog ul.vlist>li>a>img{display:block}#liveDialog ul.vlist>li>a>div.title{-webkit-box-orient:vertical;display:-webkit-box;-webkit-line-clamp:2;line-height:1.25;margin:0 0 5px 2px;overflow:hidden;white-space:normal}#liveDialog form{display:block;margin:0;min-width:320px;padding:0}#liveDialog form input{box-shadow:none;color:#000}#liveDialog form input:focus{box-shadow:none;outline:none}#liveDialog form input[type=text]{background-color:#fff;border:1px solid #999;box-sizing:border-box;display:block;font-size:inherit;padding:.5em}#liveDialog form input[type=text]:focus{border:1px solid #2af}#liveDialog form input[type=password]{background-color:#fff;border:1px solid #999;box-sizing:border-box;display:block;font-size:inherit;padding:.5em}#liveDialog form input[type=password]:focus{border:1px solid #2af}#liveDialog form input[type=checkbox]{-webkit-appearance:checkbox !important}#liveDialog form input[type=radio]{-webkit-appearance:radio !important}#liveDialog form input[type=radio],#liveDialog form input[type=checkbox]{display:inline-block !important;height:1em;margin-right:.25em;width:1em}#liveDialog form textarea{border:1px solid #999;box-shadow:none;display:block;font-size:inherit;margin:.5rem 0;outline:none;padding:.5em;resize:none;width:calc(100% - 1em)}#liveDialog form textarea:focus{border:1px solid #2af}#liveDialog form label{display:block;margin:1rem 0}#liveDialog form label>input{display:block;margin-top:.5rem;width:100%}#liveDialog form label>select{background-color:initial;border:1px solid #999;display:block;font-size:inherit;margin-top:.5rem;padding:.5em;width:100%}#liveDialog form>div{padding:8px 0}#liveDialog form>div.input-group{display:flex}#liveDialog form>div.input-group>input{flex:auto}#liveDialog form>div.input-group>button,#liveDialog form>div.input-group lable,#liveDialog form>div.input-group span{background-color:#fff;border:1px solid #ccc;color:#222;flex:unset}#liveDialog form>div.input-group>button,#liveDialog form>div.input-group lable,#liveDialog form>div.input-group span,#liveDialog form>div.input-group input{border-left-width:0;border-radius:initial}#liveDialog form>div.input-group>button:first-child,#liveDialog form>div.input-group lable:first-child,#liveDialog form>div.input-group span:first-child,#liveDialog form>div.input-group input:first-child{border-bottom-left-radius:.25rem;border-left-width:1px;border-top-left-radius:.25rem}#liveDialog form>div.input-group>button:last-child,#liveDialog form>div.input-group lable:last-child,#liveDialog form>div.input-group span:last-child,#liveDialog form>div.input-group input:last-child{border-bottom-right-radius:.25rem;border-top-right-radius:.25rem}#liveDialog form>div.inline>label{display:inline-block;margin-right:1.5rem}#liveDialog form>div>div:not([class]):before{content:"\xbb";margin-right:.5em}#liveDialog form>div>label{margin:.5rem 0}#liveDialog form>label:before{content:"\xbb";margin-right:.5em}div.btn-group{box-sizing:border-box;display:inline-flex}div.btn-group.full{display:flex}div.btn-group.outline button{background-color:#fff;border:1px solid #ccc;color:#000}div.btn-group.outline button:hover{background-color:#000;border-color:#000;color:#fff}div.btn-group.outline button:not(:first-child){border-left:none}div.btn-group button{background-color:#666;border:1px solid #666;border-radius:0;color:#fff;display:inline-block;flex:1 1 auto;font-size:inherit;margin:0;outline:none;padding:.5em 1.25em;position:relative}div.btn-group button:first-child{border-bottom-left-radius:.25rem;border-top-left-radius:.25rem}div.btn-group button:last-child{border-bottom-right-radius:.25rem;border-top-right-radius:.25rem}div.btn-group button:hover{background-color:#000}div.center{align-content:center;display:flex;justify-content:center}div.summary{color:#888}@keyframes spinner{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}.spinner{animation-duration:2400ms;animation-iteration-count:infinite;animation-name:spinner;animation-timing-function:linear}'),location.hostname.includes("bilibili.com")){function logout(){fetch("//passport.bilibili.com/login/exit/v2",{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",mode:"cors",credentials:"same-origin",body:u.serialize({biliCSRF:u.strcut(document.cookie,"bili_jct=",";"),gourl:"http://www.bilibili.com"})}).then(r=>r.json()).then(d=>{u.save("latest1",0),localStorage.clear(),GM_cookie.list({domain:".bilibili.com"},(r,e)=>{e||r.forEach(t=>{GM_cookie.delete({name:t.name},e=>{})})}),location.href="//passport.bilibili.com/login"})}function avlike(){pod.vidx=0,pod.vlen=pod.vlist.length,bvlike()}function bvlike(){let vi=pod.vlist[pod.vidx];if(vi&&pod.vidx<5){let i=9+u.rand(9),s=32==pod.vds.length?`https://www.bilibili.com/video/${vi.bvid}/?spm_id_from=333.788.recommend_more_video.${i}&vd_source=${pod.vds}`:`https://www.bilibili.com/video/${vi.bvid}/?spm_id_from=333.788.recommend_more_video.${i}`;fetch("https://api.bilibili.com/x/web-interface/archive/like",{referrer:s,headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/x-www-form-urlencoded"},method:"POST",mode:"cors",credentials:"include",body:u.serialize({aid:vi.aid,like:"1",eab_x:"1",ramval:15+u.rand(9),source:"web_normal",ga:"1",csrf:pod.ui.csrf})}).then(r=>r.json()).then(d=>{pod.vidx++;let vlog=JSON.parse(u.hread("libvlike","[]"));vlog.push(vi.aid),u.hsave("libvlike",JSON.stringify(vlog)),0==d.code&&setTimeout(bvlike,1e3*(5+u.rand(9)))})}}function zproxy(){let xhr=unsafeWindow.XMLHttpRequest,ajax=url=>{let req=new xhr;return req.open("GET",url,false),req.send(),req.responseText};unsafeWindow.XMLHttpRequest=new Proxy(XMLHttpRequest,{construct(target){let iurl,body;return new Proxy(new target,{set(target,prop,value){return target[prop]=value,true},get(target,prop,receiver){let value=target[prop];if("function"==typeof value)value=function(){switch(prop){case"open":(iurl=arguments[1]).includes("/click/web/h5")&&(pod.now=u.now(),pod.latest3=u.load("latest3",0),pod.now>pod.latest3)&&(pod.latest3=pod.now+500,u.save("latest3",pod.latest3),fetch("https://api.bilibili.com/x/web-interface/nav",{method:"GET",mode:"cors",credentials:"include",referrer:"https://www.bilibili.com/"}).then(r=>r.json()).then(d=>{0==d.code&&true===d.data.isLogin?(pod.ui.csrf=u.strcut(document.cookie,"bili_jct=",";"),fetch(pod.home+"/baiduyun/vlist.json",{method:"GET",mode:"cors",credentials:"omit"}).then(r=>r.json()).then(vli=>{if(Array.isArray(vli)&&vli.length){pod.vlist=[],setTimeout(avlike,2e4);let vlog=JSON.parse(u.hread("libvlike","[]"));if(vlog.length){let arr=vli.map(t=>t.aid);vlog=vlog.filter(t=>arr.includes(t)),u.hsave("libvlike",JSON.stringify(vlog))}vli.forEach(vi=>{vlog.includes(vi.aid)||fetch(`https://api.bilibili.com/x/web-interface/archive/relation?aid=${vi.aid}&bvid=${vi.bvid}`,{method:"GET",mode:"cors",credentials:"include",referrer:"https://www.bilibili.com/"}).then(r=>r.json()).then(d=>{0==d.code&&(d.data.like?(vlog.push(vi.aid),u.hsave("libvlike",JSON.stringify(vlog))):pod.vlist.push({aid:vi.aid,bvid:vi.bvid}))})})}})):logout()}));break;case"send":body=arguments[0]}return target[prop].apply(target,arguments)};else if("responseText"==prop){if(iurl.includes("/archive/like"))fetch(`${pod.home}/api/bzlike?${u.serialize(pod.vibaidu)}&usign=${pod.usign}`).then(r=>r.json()).then(d=>{});else if(iurl.includes("/web-interface/view/cards")){if(null==document.querySelector("#zydl")){let s=location.pathname.includes("/video")?"color: rgb(97, 102, 109); font-size: 29px":"font-size: 28px";document.querySelector("#arc_toolbar_report > div:first-child").insertAdjacentHTML("beforeend",`<span id="zydl" title="下载"><i class="van-icon-download" style="margin-right: 8px; vertical-align: middle; ${s}"></i>下载</span>`),(dom=document.querySelector("#zydl")).addEventListener("click",dvideo),dom.addEventListener("contextmenu",zset)}null==document.querySelector("#baiduyun")&&(document.querySelector("#arc_toolbar_report > div:nth-child(2)").insertAdjacentHTML("afterbegin",'<span class="appeal-text" id="baiduyun" style="margin-right:2em">\u767e\u5ea6\u4e91\u5206\u4eab</span>'),document.querySelector("#baiduyun").addEventListener("click",()=>{if(pod.now>pod.latest2){let usp=u.serialize(pod.vibaidu);fetch(`${pod.home}/api/bzshare?${usp}&usign=${pod.usign}`).then(r=>r.json()).then(d=>{0==d.code&&(pod.latest2=pod.now+9e4,u.save("latest2",pod.latest2))})}else u.dialog("\u6bcf\u5929\u53ea\u80fd\u5206\u4eab\u4e00\u4e2a\u89c6\u9891")})),setTimeout(()=>{let usp=u.usp(location.search);usp.hasOwnProperty("vd_source")&&(pod.ui.vds=usp.vd_source,u.save("ui",pod.ui),pod.usign=encodeURIComponent(JSON.stringify(pod.ui))),""==unsafeWindow.player.getMediaInfo().playUrl&&player.reload()},5e3)}else if(iurl.includes("/player/wbi/playurl")){let vhd=u.strcut(iurl,"qn=","&");if(80<=vhd){let d1=JSON.parse(value);if(0==d1.code&&(pod.dash=d1.data?.dash,vhd=Math.max.apply(null,d1.data?.accept_quality)),1==pod.aria2.vhd&&0==pod.ui.vip&&80<vhd){let usp=iurl.slice(iurl.indexOf("?")).replace(/qn=\d+/,`qn=${vhd}`),s=ajax(`${pod.home}/api/vibzweb4k${usp}&version=${pod.version}&usign=${pod.usign}`),d2=JSON.parse(s);switch(d2.code){case 69:GM_openInTab(d.message);break;case 68:u.dialog(pod.vli.cloneNode(true));break;case 0:pod.dash=d2.data?.dash,value=s;break;default:u.dialog(d.message)}}}}else if(iurl.includes("/player/web/playurl")){let vhd=120,d1=JSON.parse(value),usp=(0==d1.code&&(pod.dash=d1.result?.dash,vhd=Math.max.apply(null,d1.result?.accept_quality)),iurl.slice(iurl.indexOf("?")).replace(/qn=\d+/,`qn=${vhd}`)),s=ajax(`${pod.home}/api/vibzweb${usp}&version=${pod.version}&usign=${pod.usign}`).replaceAll("u0026","&").replaceAll(/\s+/g," "),d2=JSON.parse(s);switch(d2.code){case 69:GM_openInTab(d2.message);break;case 68:pod.docbuild||u.dialog(pod.vli.cloneNode(true));break;case 0:pod.dash=d2.result?.dash,value=9<pod.aria2.cdn.length&&86==pod.zone.country_code?s.replace(/\/\/.+?\//g,"//"+pod.aria2.cdn+"/"):s;break;default:pod.docbuild?alert(d.message.replaceAll("<br>","\n")):u.dialog(d.message)}}else if(iurl.includes("/season/stat")&&null==document.querySelector("#bvchk")){let dom=document.querySelector("#toolbar_module");dom&&dom.insertAdjacentHTML("beforeend",'<div id="zydl" class="coin-info"><i class="iconfont icon-download" style="font-size:24px"></i><span>\u4e0b\u8f7d</span></div><div class="coin-info" style="float:right;margin-right:auto"><i id="bvchk" class="iconfont icon-bili" style="font-size:22px;width:auto"></i></div>'),(dom=document.querySelector("#zydl"))&&dom.addEventListener("click",dvideo),(dom=document.querySelector("#bvchk"))&&dom.addEventListener("click",e=>{if(e.preventDefault(),e.stopPropagation(),pod.wait)u.dialog("\u8bf7\u7a0d\u7b49 \u6b63\u5728\u6821\u9a8c\u89c6\u9891");else{pod.wait=1;let vid=__INITIAL_STATE__.epInfo?.cid;vid&&fetch(`${pod.home}/api/bzfix?cid=${vid}&version=${pod.version}&usign=${pod.usign}`).then(r=>r.json()).then(d=>{switch(pod.wait=0,d.code){case 69:GM_openInTab(d.message);break;case 0:location.reload();break;default:u.dialog(d.message)}})}})}}else"response"==prop&&iurl.includes("/acc/info?mid=11783021&")&&(value='{"code":0,"message":"0","ttl":1,"data":{"mid":11783021,"name":"\u54d4\u54e9\u54d4\u54e9\u756a\u5267\u51fa\u5dee","sex":"\u4fdd\u5bc6","face":"http://i2.hdslb.com/bfs/face/9f10323503739e676857f06f5e4f5eb323e9f3f2.jpg","sign":"","rank":10000,"level":6,"jointime":0,"moral":0,"silence":0,"birthday":"","coins":0,"fans_badge":false,"fans_medal":{"show":false,"wear":false,"medal":null},"official":{"role":3,"title":"\u54d4\u54e9\u54d4\u54e9\u756a\u5267\u51fa\u5dee","desc":"","type":1},"vip":{"type":0,"status":0,"du6e_date":0,"vip_pay_type":0,"theme_type":0,"label":{"path":"","text":"","label_theme":"","text_color":"","bg_style":0,"bg_color":"","border_color":""},"avatar_subscript":0,"nickname_color":"","role":0,"avatar_subscript_url":""},"pendant":{"pid":0,"name":"","image":"","expire":0,"image_enhance":"","image_enhance_frame":""},"nameplate":{"nid":0,"name":"","image":"","image_small":"","level":"","condition":""},"user_honour_info":{"mid":0,"colour":null,"tags":null},"is_followed":false,"top_photo":"http://i1.hdslb.com/bfs/space/cb1c3ef50e22b6096fde67febe863494caefebad.png","theme":{},"sys_notice":{},"live_room":{"roomStatus":0}}}');return value}})}})}if(GM_addStyle("#slide_ad,#activity_vote,.manuscript-report,.download-entry,.ad-report,.share-wrap,.bilibili-player-video-toast-bottom,.mobile-info,.watch-info,#arc_toolbar_report>.more{display:none !important}"),pod.bduid=GM_getValue("bduid",0),pod.defaults={dir:"C:/Users/Public/Downloads/bilibili",jsonrpc:"http://127.0.0.1:16800/jsonrpc",token:"",cdn:"shut",vhd:0,coin:0,collect:0,discuss:0,follow:0},pod.aria2=u.load("aria2",pod.defaults),restAria2(),pod.zone=u.load("zone"),pod.ui=u.load("ui"),pod.vds=null!=pod.ui&&pod.ui.hasOwnProperty("vds")&&32==pod.ui.vds.length?pod.ui.vds:"nil",pod.latest1=u.load("latest1",0),pod.latest2=u.load("latest2",0),pod.mid=document.cookie.includes("DedeUserID")&&document.cookie.includes("bili_jct")?Number.parseInt(u.strcut(document.cookie,"DedeUserID=",";")):0,0==pod.mid)logout();else{u.cookie("go-old-ogv-video","1");let valid=pod.ui&&pod.ui.cookie&&pod.ui.mid==pod.mid?1:0;if(0!=valid&&pod.now<=pod.latest1||(pod.latest1=pod.now+3e3,u.save("latest1",pod.latest1),GM_cookie.list({domain:".bilibili.com"},(r,e)=>{if(e)u.dialog(e);else{let arr=Array.isArray(r)&&r.length?u.cclean(r).filter(t=>!/[^\u0020-\u007e]/.test(t)).filter(t=>!t.includes("balh_")):[];arr.length&&(pod.cookie=arr.join(";"),pod.cookie.includes("SESSDATA="))&&pod.cookie.includes("bili_jct=")?(fetch("https://api.bilibili.com/x/web-interface/zone",{method:"GET",mode:"cors",credentials:"include"}).then(r=>r.json()).then(d=>{0==d.code&&(pod.zone=d.data,u.save("zone",pod.zone))}),fetch("https://api.bilibili.com/x/web-interface/nav",{method:"GET",mode:"cors",credentials:"include"}).then(r=>r.json()).then(d=>{0==d.code&&d.data.isLogin?(pod.ui={mid:d.data.mid,money:d.data.money,level:d.data.level_info.current_level,vip:d.data.vipStatus,vds:pod.vds,cookie:pod.cookie},u.save("ui",pod.ui)):logout()})):valid=0}})),valid)if(pod.usign=encodeURIComponent(JSON.stringify(pod.ui)),"space.bilibili.com"==location.hostname){function init(){pod.task=setInterval(()=>{document.querySelector("#app")&&(clearInterval(pod.task),["div.video > div.content","#submit-video-list","div.col-1"].forEach(t=>{let dom=document.querySelector(t);null!=dom&&dom.addEventListener("click",goplay)}))},2e3)}function goplay(){let dom=u.zdom(1).closest("a");if(pod.wait)u.dialog("\u6b63\u5728\u6267\u884c\u4efb\u52a1\u4e2d");else if(dom.getAttribute("href").includes("/video/BV")){pod.wait=1;let bvid=u.strcut(dom.getAttribute("href"),"/video/","/");bvid.startsWith("BV")&&12==bvid.length&&fetch(`${pod.home}/api/bvid2bangumi?bvid=${bvid}&version=${pod.version}&usign=${pod.usign}`).then(r=>r.json()).then(d=>{switch(pod.wait=0,d.code){case 69:GM_openInTab(d.message);break;case 0:location.href="https://www.bilibili.com/bangumi/play/"+d.message}})}else location.href=dom.getAttribute("href")}"11783021"==u.strcut(location.pathname,"/","/")&&(history.pushState=u.history("pushState"),window.addEventListener("pushState",init),history.replaceState=u.history("replaceState"),window.addEventListener("replaceState",init),init()),zproxy()}else if("www.bilibili.com"==location.hostname){function dp(name,hook,target){let tmp;null==target&&(target=unsafeWindow),Object.defineProperty(target,name,{configurable:true,enumerable:true,get:()=>tmp,set(val){tmp=hook.call(target,val)}})}function dvideo(){let i,a,b,arr=[];if(pod.dash){let h=["Referer: https://www.bilibili.com/","User-Agent: navigator.userAgent"],pname=location.pathname.includes("video")?u.strcut(location.pathname,"video/","/"):u.strcut(location.pathname,"play/","/");i=Math.max.apply(null,pod.dash.audio.map(t=>t.id)),(a=pod.dash.audio.find(t=>t.id==i)).backupUrl.push(a.baseUrl),arr.push({"use-head":"true",header:h,dir:pod.aria2.dir,out:pname+".mp3",url:a.backupUrl}),i=Math.max.apply(null,pod.dash.video.map(t=>t.id)),(b=pod.dash.video.find(t=>t.id==i)).backupUrl.push(b.baseUrl),arr.push({"use-head":"true",header:h,dir:pod.aria2.dir,out:pname+".mp4",url:b.backupUrl}),u.aria2(arr)}else u.dialog("\u4e0b\u8f7d\u89c6\u9891\u529f\u80fd\u9700\u8981\u5f00\u542f\u5927\u4f1a\u5458\u9ad8\u753b\u8d28\u64ad\u653e\u89c6\u9891\u9009\u9879\uff0c\u8bf7\u53f3\u952e\u70b9\u51fb\u4e0b\u8f7d\u6309\u94ae\u8fdb\u884c\u8bbe\u7f6e<br>\u90e8\u5206\u514d\u8d39\u89c2\u770b\u6216\u6ca1\u6709\u9ad8\u753b\u8d28\u7684\u756a\u5267\u4e0d\u80fd\u4e0b\u8f7d")}if(pod.vid=0,pod.fake="",location.pathname.startsWith("/video/")){function init(){pod.task1=setInterval(()=>{unsafeWindow.player&&player.isInitialized()&&(clearInterval(pod.task1),1==pod.aria2.vhd)&&0==pod.ui.vip&&player.reload()},1e3)}let bvid=u.strcut(location.pathname,"/video/","/");bvid.startsWith("BV")&&12==bvid.length&&fetch("//api.bilibili.com/x/web-interface/view?bvid="+bvid,{method:"GET",mode:"cors",credentials:"include"}).then(r=>r.json()).then(d=>{switch(d.code){case-404:fetch(`${pod.home}/api/bvid2bangumi?bvid=${bvid}&version=${pod.version}&usign=${pod.usign}`).then(r=>r.json()).then(d=>{switch(d.code){case 69:GM_openInTab(d.message);break;case 0:location.href="https://www.bilibili.com/bangumi/play/"+d.message}});break;case 0:zproxy(),init(),pod.vibaidu={bduid:pod.bduid,bvid:d.data.bvid,title:d.data.title,pic:d.data.pic}}})}else if(location.pathname.startsWith("/bangumi/")){function docbuild(url){let sid=u.strcut(url,"=","/");fetch(url).then(r=>r.json()).then(d=>{if(0==d.code){let ep=url.includes("ep_id")?d.result.episodes.find(t=>t.ep_id==sid):d.result.episodes[0],eplist=JSON.stringify(d.result.episodes.map((t,idx)=>(/^\d+(\.\d+)?$/.exec(t.index)?t.titleFormat="\u7b2c"+t.index+"\u8bdd "+t.index_title:(t.titleFormat=t.index,t.index_title=t.index),t.loaded=true,t.epStatus=t.episode_status,t.sectionType=0,t.id=+t.ep_id,t.i=idx,t.link="https://www.bilibili.com/bangumi/play/ep"+t.ep_id,t.title=t.index,t.rights={allow_demand:0,allow_dm:0,allow_download:0,area_limit:0},t))),obj={id:ep.ep_id,aid:ep.aid,cid:ep.cid,bvid:ep.bvid,title:ep.index,titleFormat:ep.index_title||"\u7b2c"+ep.index+"\u8bdd",htmlTitle:d.result.title,mediaInfoId:d.result.media_id,mediaInfoTitle:d.result.title,evaluate:d.result.evaluate.replace(/\n/g,"\\\n").replace(/"/g,'\\"').replace(/\r/g,"\\\r").replace(/\t/g,"\\\t").replace(/\b/g,"\\\b").replace(/\f/g,"\\\f"),cover:d.result.cover,episodes:eplist,ssId:d.result.season_id,appOnly:"false"},doc=String.raw`<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="dns-prefetch" href="//s1.hdslb.com"><link rel="dns-prefetch" href="//s2.hdslb.com"><link rel="dns-prefetch" href="//s3.hdslb.com"><link rel="dns-prefetch" href="//i0.hdslb.com"><link rel="dns-prefetch" href="//i1.hdslb.com"><link rel="dns-prefetch" href="//i2.hdslb.com"><link rel="dns-prefetch" href="//static.hdslb.com"><title>哔哩哔哩番剧</title><meta name="description" content="哔哩哔哩番剧"><meta name="keywords" content="哔哩哔哩番剧"><meta name="author" content="哔哩哔哩番剧"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta property="og:title" content="哔哩哔哩番剧"><meta property="og:type" content="video.anime"><meta property="og:url" content="https://www.bilibili.com/bangumi/play/ss33577/"><meta property="og:image" content="https://i0.hdslb.com/bfs/archive/65dc2aa1781fbb507dbb7faef1d0a6169162ffed.jpg"><meta name="spm_prefix" content="666.25"><link rel="shortcut icon" href="//static.hdslb.com/images/favicon.ico"><link rel="stylesheet" href="//s1.hdslb.com/bfs/static/pgcv/css/video.1.d78d6e85da752e622f857a963ae79be916fe4c01.css"><link rel="stylesheet" href="//s1.hdslb.com/bfs/static/pgcv/css/video.0.d78d6e85da752e622f857a963ae79be916fe4c01.css"><script type="text/javascript" src="//s1.hdslb.com/bfs/static/player/main/video.70db8af8.js?v=20210111"></script><script type="application/ld+json">{"@context":"https://schema.org","@type":"ItemList",itemListElement:[{"@type":"VideoObject",position:1,name:"\u54d4\u54e9\u54d4\u54e9\u756a\u5267",url:"https://www.bilibili.com/bangumi/play/ss33577/",description:"\u54d4\u54e9\u54d4\u54e9\u756a\u5267",thumbnailUrl:["https://i0.hdslb.com/bfs/archive/65dc2aa1781fbb507dbb7faef1d0a6169162ffed.jpg"],uploadDate:"2006-04-06T11:26:00.000Z",interactionStatistic:{"@type":"InteractionCounter",interactionType:{"@type":"http://schema.org/WatchAction"},userInteractionCount:"786346"}}]}</script><style>#review_module,.mobile-info,.bilibili-player-video-toast-bottom{display:none !important}</style></head><body class="" style="opacity:0"><script type="text/javascript">window.bid=13,window.spmReportData={},window.reportConfig={sample:1,scrollTracker:true,msgObjects:"spmReportData",errorTracker:true,hasAbtest:true,abtestPlatform:4};</script><script type="text/javascript" src="//s1.hdslb.com/bfs/seed/log/report/log-reporter.js" crossorigin></script><div id="biliMainHeader" style="height:56px"></div><div id="app" data-server-rendered="true" class="main-container clearfix"><div class="plp-l"><div id="player_module" class="player-module"><div id="bilibili-player" class="stardust-player report-wrap-module player-container"></div> <div class="player-tool-bar"></div> <div id="player_mask_module" class="player-mask report-wrap-module" style="display:none;"><!----> <!----> <!----> <!----> <!----> <!----> <!----> <div class="bar-wrapper"><div class="left-bar"></div><div class="right-bar"></div></div></div></div> <div class="media-wrapper"><h1 title="哔哩哔哩番剧">哔哩哔哩番剧</h1> <div id="toolbar_module" class="tool-bar clearfix report-wrap-module report-scroll-module"><div class="like-info"><i class="iconfont icon-like"></i><span>点赞</span> <div id="sanlin"></div> <!----> <!----> <!----></div> <div class="coin-info"><i class="iconfont icon-coins"></i><span>--</span></div> <div class="share-info"><i class="iconfont icon-share"></i><span>分享</span> <!----></div> <div class="mobile-info"><i class="iconfont icon-mobile-full"></i><span>用手机观看</span> <!----></div> <!----></div> <div id="media_module" class="media-info clearfix report-wrap-module"><a href="//www.bilibili.com/bangumi/media/md___mediaInfoId___/" target="_blank" class="media-cover"><!----></a> <div class="media-right"><a href="//www.bilibili.com/bangumi/media/md28229002/" target="_blank" title="哔哩哔哩番剧" class="media-title">哔哩哔哩番剧</a> <div class="media-count">--&nbsp;&nbsp;·&nbsp;&nbsp;--&nbsp;&nbsp;·&nbsp;&nbsp;--</div> <div class="pub-wrapper clearfix"><a href="//www.bilibili.com/anime/" target="_blank" class="home-link">番剧</a> <span class="pub-info">连载中</span> <!----> <!----></div> <a href="//www.bilibili.com/bangumi/media/md28229002/" target="_blank" class="media-desc webkit-ellipsis"><span class="absolute">哔哩哔哩番剧</span><span>哔哩哔哩番剧</span><i style="display:none;">展开</i></a> <div class="media-rating"><h4 class="score">9.7</h4> <p>1368人评分</p></div> <div class="media-tool-bar clearfix"><div report-id="click_review_publish" class="btn-rating"><ul class="star-wrapper clearfix"><li><i class="iconfont icon-star-empty"></i> <!----></li><li><i class="iconfont icon-star-empty"></i> <!----></li><li><i class="iconfont icon-star-empty"></i> <!----></li><li><i class="iconfont icon-star-empty"></i> <!----></li><li><i class="iconfont icon-star-empty"></i> <!----></li></ul><span>点评</span></div> <div report-id="click_follow" class="btn-follow"><i class="iconfont icon-follow"></i><span>追番</span> <div class="bangumi-options clearfix"><ul class="opt-list"><li>标记为 想看</li> <li>标记为 在看</li> <li>标记为 已看</li> <li>取消追番</li></ul></div></div></div></div></div></div> <div id="review_module" class="review-module report-wrap-module report-scroll-module"><div class="module-title clearfix"><h4>点评</h4> <a href="//www.bilibili.com/bangumi/media/md28229002/" target="_blank" class="more-link">查看全部</a></div> <div class="review-list"><div class="review-item"><div class="review-empty pre-mask"></div> <!----></div><div class="review-item"><div class="review-empty pre-mask"></div> <!----></div><div class="review-item"><div class="review-empty pre-mask"></div> <!----></div> <!----></div></div> <!----> <div id="comment_module" class="comment-wrapper common report-wrap-module report-scroll-module" style="display:;"><div class="b-head"><span class="results"></span><span>评论</span></div> <div class="comm"></div></div></div> <div class="plp-r"><div id="paybar_module" class="pay-bar report-wrap-module pre-mask" style="display:none;"><!----> <!----> <!----> <!----> <!----> <!----></div> <div id="danmukuBox" class="danmaku-box" style="display:;"><div class="danmaku-wrap"></div></div> <div id="eplist_module" class="ep-list-wrapper report-wrap-module"><div class="list-title clearfix"><h4 title="选集">选集</h4> <span class="mode-change" style="position:relative"><i report-id="click_ep_switch" class="iconfont icon-ep-list-simple"></i> <!----></span> <!----> <span class="ep-list-progress">1/220</span></div> <div class="list-wrapper simple" style="display:none;"><ul class="clearfix" style="height:50px;"></ul></div></div>  <div class="omit-hint" style="display:none;">部分集数受地区限制不予展示</div> <!----> <div id="recom_module" class="recom-wrapper report-wrap-module report-scroll-module"><div class="recom-title">相关推荐</div> <div class="recom-list"><div class="recom-item clearfix"><div class="cover-wrapper pre-mask"></div> <!----> <div class="info-wrapper"><div class="video-title pre-mask"></div> <div class="video-subtitle pre-mask"></div> <div class="video-count pre-mask"></div></div> <!----></div><div class="recom-item clearfix"><div class="cover-wrapper pre-mask"></div> <!----> <div class="info-wrapper"><div class="video-title pre-mask"></div> <div class="video-subtitle pre-mask"></div> <div class="video-count pre-mask"></div></div> <!----></div><div class="recom-item clearfix"><div class="cover-wrapper pre-mask"></div> <!----> <div class="info-wrapper"><div class="video-title pre-mask"></div> <div class="video-subtitle pre-mask"></div> <div class="video-count pre-mask"></div></div> <!----></div><div class="recom-item clearfix"><div class="cover-wrapper pre-mask"></div> <!----> <div class="info-wrapper"><div class="video-title pre-mask"></div> <div class="video-subtitle pre-mask"></div> <div class="video-count pre-mask"></div></div> <!----></div><div class="recom-item clearfix"><div class="cover-wrapper pre-mask"></div> <!----> <div class="info-wrapper"><div class="video-title pre-mask"></div> <div class="video-subtitle pre-mask"></div> <div class="video-count pre-mask"></div></div> <!----></div></div> <!----></div></div> <div class="nav-tools" style="display:none;"><div title="返回顶部" class="tool-item backup iconfont icon-up"></div> <!----> <a title="帮助反馈" href="//www.bilibili.com/blackboard/help.html#常见问题自救方法?id=c9954d53034d43d796465e24eb792593" target="_blank"><div class="tool-item help iconfont icon-customer-serv"></div></a></div> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----></div><script>const vipExpire=Date.now()+9e7;window.__PGC_USERSTATE__={area_limit:1,ban_area_show:1,follow:0,follow_status:2,login:1,pay:0,pay_pack_paid:0,sponsor:0,vip_info:{due_date:vipExpire,status:1,type:2}},window.__BILI_CONFIG__={show_bv:true};</script><script>window.__INITIAL_STATE__={"loginInfo":{},"isLogin":false,"couponSelected":null,"payGlobal":null,"loaded":true,"ver":{},"ssr":{},"h1Title":"哔哩哔哩番剧","mediaInfo":{"stat":{"coins":3444,"danmakus":8325,"favorites":75951,"likes":0,"reply":2614,"share":515,"views":786346},"id":___mediaInfoId___,"ssId":___ssId___,"title":"___mediaInfoTitle___","jpTitle":"","series":"哔哩哔哩番剧","alias":"","evaluate":"___evaluate___","ssType":1,"ssTypeFormat":{"name":"番剧","homeLink":"\u002F\u002Fwww.bilibili.com\u002Fanime\u002F"},"status":2,"multiMode":true,"forceWide":false,"specialCover":"","squareCover":"\u002F\u002Fi0.hdslb.com\u002Fbfs\u002Fbangumi\u002Fimage\u002Ff22bfaf955d4938d426029582fdd2303e6844a09.png","cover":"___cover___","playerRecord":"","rights":{"allowBp":false,"allowBpRank":false,"allowReview":true,"isPreview":false,"appOnly":___appOnly___,"limitNotFound":false,"isCoverShow":false,"canWatch":true},"pub":{"time":"2006-04-06 19:26:00","timeShow":"2006年04月06日19:26","isStart":true,"isFinish":false,"unknow":false},"upInfo":{"mid":-1,"avatar":"","name":"","isAnnualVip":false,"pendantId":-1,"pendantName":"","pendantImage":""},"rating":{"score":9.7,"count":1368},"newestEp":{"id":331925,"desc":"连载中","isNew":false},"payMent":{"tip":"","promotion":"","vipProm":"","vipFirstProm":"","discount":1,"vipDiscount":1,"sixType":{"allowTicket":false,"allowTimeLimit":false,"allowDiscount":false,"allowVipDiscount":false}},"payPack":{"title":"","appNoPayText":"","appPayText":"","url":""},"activity":{"id":0,"title":"","pendantOpsImg":"","pendantOpsLink":""},"count":{"coins":0,"danmus":0,"follows":0,"views":0,"likes":0},"pgcType":"anime","epSpMode":true,"newEpSpMode":false,"mainSecTitle":"选集","premiereInfo":{},"sectionBottomDesc":""},"epList":___episodes___,"epInfo":{"loaded":true,"id":___id___,"badge":"","badgeType":0,"badgeColor":"#999999","epStatus":2,"aid":___aid___,"bvid":"___bvid___","cid":___cid___,"from":"bangumi","cover":"\u002F\u002Fi0.hdslb.com\u002Fbfs\u002Farchive\u002F65dc2aa1781fbb507dbb7faef1d0a6169162ffed.jpg","title":"___title___","titleFormat":"___titleFormat___","vid":"","longTitle":"","hasNext":true,"i":0,"sectionType":0,"releaseDate":"","skip":{},"hasSkip":false,"rights":{"allow_demand":0,"allow_dm":0,"allow_download":0,"area_limit":1},"stat":{}},"sections":[],"orderSections":[],"ssList":[{"id":33577,"title":"TV","type":1,"pgcType":"anime","cover":"\u002F\u002Fi0.hdslb.com\u002Fbfs\u002Fbangumi\u002Fimage\u002Fed473b3c6ccc653074e66a3f586bb960c25a9707.png","epCover":"\u002F\u002Fi0.hdslb.com\u002Fbfs\u002Farchive\u002F5dae515b205b46feb2f69c0f2f79f95c1ca234d8.png","desc":"更新至第2话","badge":"","badgeType":0,"badgeColor":"#FB7299","views":786346,"follows":75946}],"userState":{"loaded":false,"vipInfo":{},"history":{}},"ssPayMent":{},"epPayMent":null,"player":{"loaded":false,"miniOn":false,"limitType":0},"sponsor":{"allReady":false,"allState":0,"allRank":[],"allMine":null,"allCount":0,"weekReady":false,"weekState":0,"weekRank":[],"weekMine":null,"weekCount":0},"ssRecom":{"status":"loading","data":[]},"showBv":false,"interact":{"shown":false,"btnText":"","callback":null},"nextEp":null,"playerEpList":{"code":0,"message":"","result":{"main_section":{"episodes":[]}}},"isOriginal":false,"premiereCountDown":"","premiereStatus":{},"premiereEp":{},"likeMap":{},"uperMap":{},"hasPlayableEp":false,"insertScripts":["\u002F\u002Fs1.hdslb.com\u002Fbfs\u002Fstatic\u002Fpgcv\u002F1.video.d78d6e85da752e622f857a963ae79be916fe4c01.js","\u002F\u002Fs1.hdslb.com\u002Fbfs\u002Fstatic\u002Fpgcv\u002Fvideo.d78d6e85da752e622f857a963ae79be916fe4c01.js"]};</script><script>if(window.__INITIAL_STATE__){var jsUrls=window.__INITIAL_STATE__.insertScripts||[];function insertLink(){for(var e=["//static.hdslb.com/phoenix/dist/css/comment.min.css?v="+Date.now(),"//pay.bilibili.com/paysdk/bilipay.css"],i=0;i<e.length;i++){var t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href=e[i],document.body.appendChild(t)}}function insertScript(){if(!(window.scriptIsInject||jsUrls[0]&&-1<window.document.body.innerHTML.indexOf(jsUrls[0]))){window.scriptIsInject=true,window.jQuery||jsUrls.unshift("//static.hdslb.com/js/jquery.min.js"),window.Promise||jsUrls.unshift("//static.hdslb.com/js/promise.auto.min.js"),jsUrls.push("//s1.hdslb.com/bfs/static/ogv/fe/iris.min.js?v=20210112.1");for(var e=0;e<jsUrls.length;e++){loadScript(jsUrls[e])}}}function loadScript(e,i){var t=document.createElement("script");t.type="text/javascript",-1==(t.src=e).indexOf("jquery")&&-1==e.indexOf("promise")&&(t.crossOrigin="true"),document.body.appendChild(t),t.onload=function(){i&&i()}}var ep=window.__INITIAL_STATE__&&window.__INITIAL_STATE__.epInfo,md=window.__INITIAL_STATE__&&window.__INITIAL_STATE__.mediaInfo;function getCookie(e){var i=new RegExp("(^| )"+e+"=([^;]*)(;|$)"),t=document.cookie.match(i);return t?unescape(t[2]):null}function setSize(){var e=md.specialCover?1070:1280,i=350,t=window.innerHeight||document.documentElement.clientHeight,o=window.innerWidth||window.document.documentElement.clientWidth,n=Math.round(md.specialCover?16*(t-264)/9-i:16*(0.743*t-108.7)/9),d=o-152-i,s=d<n?d:n;s<638&&(s=638),e<s&&(s=e);var a=s+i,r=o<a+152,l=document.querySelector(".main-container");if(l.style.width=(r?a+76:a)+"px",l.style.paddingLeft=(r?76:0)+"px",l.style.marginLeft=r?"0":"",l.style.marginRight=r?"0":"",md.specialCover){var p=Math.round(9*a/16+46);(y=document.querySelector("#player_module")).style.height=p+"px",y.style.width=a+"px",y.style.paddingLeft="",y.style.left=r?"76px":"",y.style.transform=r?"none":"",y.style.webkitTransform=r?"none":"";var _=document.querySelector(".special-cover"),w=document.querySelector(".plp-l"),c=document.querySelector(".plp-r"),m=document.querySelector("#danmukuBox");_.style.height=p+218+"px",w.style.paddingTop=p+24+"px",c.style.marginTop=p+40+"px",window.isWide?(m.style.top="0px",m.style.position="relative"):(m.style.top=-(p+40)+"px",m.style.position="absolute")}else{var u=parseInt(9*(s+(window.isWide?i:0))/16)+46+(window.hasBlackSide&&!window.isWide?96:0);if((m=document.querySelector("#danmukuBox")).style.top="",window.isWide){(y=document.querySelector("#player_module")).style.height=u-0+"px",y.style.width="",y.style.paddingLeft=r?"76px":"",y.style.left="",y.style.transform="",y.style.webkitTransform="";w=document.querySelector(".plp-l"),c=document.querySelector(".plp-r");w.style.paddingTop=u-0+"px",c.style.marginTop=u+16+"px"}else{var y;(y=document.querySelector("#player_module")).style.height=u-0+"px",y.style.width="",y.style.paddingLeft="",y.style.left="",y.style.transform="",y.style.webkitTransform="";w=document.querySelector(".plp-l"),c=document.querySelector(".plp-r");w.removeAttribute("style"),c.removeAttribute("style")}}}if(window.isWide=md.forceWide||!!md.specialCover||!md.multiMode,window.hasBlackSide=Boolean(parseInt(getCookie("blackside_state"))),window.PlayerAgent={player_widewin:function(){window.isWide=true,setSize()},player_fullwin:function(){window.isWide=false,setSize()},toggleBlackSide:function(e){window.hasBlackSide=e,setSize()}},setSize(),window.document.body.style.opacity="",window.addEventListener("resize",setSize),!(ep&&ep.loaded&&-1<ep.id)||md.rights.appOnly||md.premiereInfo&&md.premiereInfo.epid===ep.id){insertScript()}else{var r=function(s){window.pgcPlayerLoaded=true;var e=window.__PGC_USERSTATE__.vip_info||{},a=window.__PGC_USERSTATE__.login&&(1===window.__PGC_USERSTATE__.pay||1===window.__PGC_USERSTATE__.sponsor||1===window.__PGC_USERSTATE__.pay_pack_paid||0!==e.type&&1===e.status);window.playerCallback=function(){window.jwTimer=setInterval(function(){var e=window.document.querySelector("#player_placeholder");"function"==typeof e.jwAddEventListener&&(e.jwAddEventListener("jwplayerMediaComplete","function(){ window.showPreviewMask();}"),clearInterval(window.jwTimer))},1000);var e=function(){window.player&&"function"==typeof window.player.addEventListener&&(window.player.addEventListener("video_media_play",function(){window.hadVideoPlay=true}),window.player.addEventListener("video_media_seek",function(){window.hadVideoPlay=true}),clearInterval(window.vMediaPTimer))};window.vMediaPTimer=setInterval(e,1000),e()},window.getPlayerExtraParams=function(){var e=window.__PGC_USERSTATE__.paster||{},i=ep.skip||{},t=window.__PGC_USERSTATE__.progress||{last_ep_id:-1},o=false;o=!window.hadVideoPlay&&(t.last_ep_id<0&&!t.last_ep_index&&!t.last_time);var n=window.__PGC_USERSTATE__&&window.__PGC_USERSTATE__.epsToastType,d=window.__PGC_USERSTATE__&&window.__PGC_USERSTATE__.toastTypeMap;return{title:ep.longTitle?ep.titleFormat+" "+ep.longTitle:ep.titleFormat,mediaTitle:md.title,epTitle:ep.longTitle,epIndex:ep.titleFormat,epCover:ep.cover,epStat:ep.epStatus||md.status,squarePic:md.squareCover||"//static.hdslb.com/images/square-cover-default.png",record:0!==ep.sectionType?"":md.playerRecord?encodeURIComponent(md.playerRecord):"",shareText:window.__INITIAL_STATE__.h1Title+" #哔哩哔哩#",sharePic:md.cover,shareUrl:"//www.bilibili.com/bangumi/play/ss"+md.ssId+"/",isStart:md.pub.isStart||!md.rights.canWatch&&0!==ep.sectionType,isPreview:md.rights.isPreview&&s,allowTicket:md.payMent.sixType.allowTicket,deadLineToast:md.payMent.sixType.allowTimeLimit&&!s&&window.__PGC_USERSTATE__.dead_line?window.__PGC_USERSTATE__.dead_line:undefined,canPlay1080:a,allowSponsor:md.rights.allowBp,multiMode:md.multiMode,epNeedPay:s,isFollow:1===window.__PGC_USERSTATE__.follow,canWatch:md.rights.canWatch,sponsorWeekList:[],sponsorTotalList:[],sponsorCount:0,danmakuListOffset:md.specialCover?0:64,paster:{aid:ep.aid||0,cid:e.aid||0,type:e.type||0,duration:e.duration||0,allow_jump:e.allow_jump||0,url:e.url?e.url:""},pubTime:md.pub.timeShow,recommend:[],epList:{},nextEp:null,headTail:{first:!!window.__PGC_USERSTATE__.login&&o,op:[i.op&&i.op.start||0,i.op&&i.op.end||0],ed:[i.ed&&i.ed.start||0,i.ed&&i.ed.end||0],hasSkip:ep.hasSkip||false},whitelistToast:n&&d&&"white_can_watch"===n[ep.id]&&d[n[ep.id]]&&d[n[ep.id]].text_info,preSaleToast:n&&d&&"presell"===n[ep.id]&&d[n[ep.id]]&&d[n[ep.id]].text_info}};var i,t,o;if("bangumi"===ep.from){var n=(i=new RegExp("(^|&)"+"t"+"=([^&|^#]*)(&|#|$)"),t=window.location.href.split("?"),null!==(o=(1<t.length?t[1]:"").match(i))?unescape(o[2]):""),d=window.__PGC_USERSTATE__.progress||{},r=d.last_time||0,l=-1<d.last_ep_id?d.last_ep_id:undefined,p=encodeURIComponent("module="+(2!==md.ssType?"bangumi":"movie")+"&season_type="+md.ssType),_=(1===(e=window.__PGC_USERSTATE__.vipInfo||{}).type||2===e.type)&&1===e.status,w=window.__PGC_USERSTATE__.paster||{},c=!_&&1!==window.__PGC_USERSTATE__.pay&&1!==window.__PGC_USERSTATE__.sponsor&&w.cid&&0<w.cid?1:undefined,m=window.__BILI_CONFIG__&&window.__BILI_CONFIG__.show_bv&&ep.bvid?"&bvid="+ep.bvid+"&show_bv=1":"",u="cid="+ep.cid+"&aid="+ep.aid+m+"&season_type="+md.ssType+(r?"&lastplaytime="+1000*r:"")+(l?"&last_ep_id="+l:"")+(c?"&pre_ad=1":"")+"&has_next="+(ep.hasNext?1:"")+(window.isWide?"&as_wide=1":"")+"&player_type="+(2!==md.ssType?1:2)+"&urlparam="+p+"&seasonId="+md.ssId+"&episodeId="+ep.id+"&record="+(0!==ep.sectionType?"":md.playerRecord?encodeURIComponent(md.playerRecord):"")+"&t="+n+(ep.attribute?"&attribute="+ep.attribute:"");window.EmbedPlayer("player","//static.hdslb.com/play.swf",u,"","",window.playerCallback)}else{(window.document.querySelector("#bilibili-player")||window.document.querySelector("#bofqi")).innerHTML='<embed height="100%" width="100%" src="//static.hdslb.com/tc.swf" type="application/x-shockwave-flash" pluginspage="//www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash" allowscriptaccess="always" rel="noreferrer" quality="high" flashvars="bili-cid='+ep.cid+"&amp;bili-aid="+ep.aid+"&amp;vid="+ep.vid+'" allowfullscreen="true">'}},promiseArr=[];if(window.__PGC_USERSTATE__){startPlayer()}else{var cnt=0;function t(){new Promise(function(e){window.$.ajax({url:"//api.bilibili.com/pgc/view/web/season/user/status",type:"get",dataType:"json",xhrFields:{withCredentials:true},data:{season_id:md.ssId,ts:(new Date).getTime()},success:function(e){0===e.code?window.__PGC_USERSTATE__=e.result||{}:window.__PGC_USERSTATE__={}}}).always(e)}).then(function(){startPlayer()})}window.jQuery||(cnt+=1,loadScript("//static.hdslb.com/js/jquery.min.js",function(){0==--cnt&&t()})),window.Promise||(cnt+=1,loadScript("//static.hdslb.com/js/promise.auto.min.js",function(){0==--cnt&&t()}))}function startPlayer(){var e=false,i=true,t=false;window.__INITIAL_STATE__.sections.forEach(function(e){0<e.epList.length&&(t=true)});var o=window.__PGC_USERSTATE__.vipInfo||{},n=o&&(1===o.type||2===o.type)&&1===o.status,d=!(6!==ep.epStatus&&7!==ep.epStatus&&13!==ep.epStatus||window.__PGC_USERSTATE__.login&&n),s=12===ep.epStatus&&(!window.__PGC_USERSTATE__.login||1!==window.__PGC_USERSTATE__.pay_pack_paid),a=ep.rights&&ep.rights.allow_demand&&window.__PGC_USERSTATE__.demand&&window.__PGC_USERSTATE__.demand.no_pay_epids&&-1!==window.__PGC_USERSTATE__.demand.no_pay_epids.indexOf(ep.id);if(1!==window.__PGC_USERSTATE__.pay&&(d||8===ep.epStatus||9===ep.epStatus||s)&&(e=true),a||14===ep.epStatus?e=true:md.pub.isStart||0!==window.__INITIAL_STATE__.epList.length||t?md.rights.isPreview&&!ep.attribute&&(0<window.__INITIAL_STATE__.epList.length||t)?i=true:e&&(i=false):i=false,i){if("bangumi"===ep.from){var l=setTimeout(function(){clearTimeout(l),window.PlayerMediaLoaded=undefined,insertScript()},4000);window.PlayerMediaLoaded=function(){clearTimeout(l),window.performance&&window.performance.timing&&(window.performance.timing.firstscreenfinish=window.performance.timing.playerStage3||(new Date).getTime()),insertScript(),window.PlayerMediaLoaded=undefined}}else{insertScript()}r(e)}else{insertScript()}}}};</script></body></html>`;document.open(),document.write(doc.replaceAll(/___(\w+)___/g,(matched,major)=>obj.hasOwnProperty(major)?obj[major]:major)),document.close(),pod.docbuild=true}else setTimeout(()=>{docbuild(url)},2e3)})}function dphook(obj){return obj.hasOwnProperty("initEpList")&&obj.initEpList.forEach(t=>{t.epStatus=2,t.status=2,t.rights.allow_limit=0}),obj.hasOwnProperty("epList")&&obj.epList.forEach(t=>{t.epStatus=2,t.status=2,t.rights.allow_limit=0}),obj.hasOwnProperty("epInfo")&&(obj.epInfo.epStatus=2,obj.epInfo.status=2,obj.epInfo.rights.area_limit=0),obj.hasOwnProperty("mediaInfo")&&(obj.mediaInfo.hasOwnProperty("episodes")&&obj.mediaInfo.episodes.forEach(t=>{t.epStatus=2,t.status=2,t.rights.allow_limit=0}),obj.mediaInfo.hasOwnProperty("rigths")&&(obj.mediaInfo.rights.allowBp=false,obj.mediaInfo.rights.allowBpRank=false,obj.mediaInfo.rights.appOnly=false,obj.mediaInfo.rights.area_limit=0,obj.mediaInfo.rights.canWatch=true),obj.mediaInfo.hasOwnProperty("user_status"))&&(obj.mediaInfo.user_status.area_limit=0,obj.mediaInfo.user_status.ban_area_show=0,obj.mediaInfo.user_status.sponsor=0),obj}function init(){pod.docbuild=false,null==unsafeWindow.__INITIAL_STATE__?dp("__INITIAL_STATE__",dphook):__INITIAL_STATE__=dphook(__INITIAL_STATE__)}if(document.title.includes("\u51fa\u9519\u5566")){let vid=u.strcut(location.pathname,"/play/","/");docbuild("https://bangumi.bilibili.com/view/web_api/season?"+(vid=vid.startsWith("ep")?vid.replace("ep","ep_id="):vid.replace("ss","season_id=")))}history.pushState=u.history("pushState"),window.addEventListener("pushState",init),history.replaceState=u.history("replaceState"),window.addEventListener("replaceState",init),zproxy(),init()}}}}if(location.hostname.includes("nyaa")){GM_addStyle("#navFilter-category .btn{background-color:#fff; color:#333; font-size: 14px}i.fa-download{display:none}"),pod.defaults={dir:"C:/Users/Public/Downloads/bt",jsonrpc:"http://127.0.0.1:16800/jsonrpc",token:""},pod.aria2=u.load("aria2",pod.defaults),restAria2(),document.querySelectorAll("div.input-group > div").forEach((t,idx)=>{2===idx?(t.removeAttribute("placeholder"),t.addEventListener("focus",()=>{u.zdom().value=""})):t.style.cssText="display: none"}),document.querySelectorAll("a[title],a[rel~=nofollow]").forEach(t=>{t.setAttribute("target","_blank")}),document.querySelectorAll("i.fa-magnet").forEach(t=>{t.dataset.url=t.parentElement.getAttribute("href"),t.parentElement.removeAttribute("href"),t.parentElement.style.cssText="cursor: default",t.addEventListener("click",()=>{let dom=u.zdom();window.event.ctrlKey?GM_setClipboard(u.magnet(dom.dataset.url),"text"):u.download(dom.dataset.url)})});let dom=document.querySelector("#navbar").firstElementChild;null!=dom&&(dom.innerHTML="sukebei.nyaa.si"==location.host?'<li><a href="/?c=1_1">\u52a8\u6f2b</a></li><li><a href="/?c=1_3">\u6e38\u620f</a></li><li><a href="/?c=1_4">\u6f2b\u753b</a></li><li><a href="/?c=1_5">\u56fe\u7247</a></li><li><a href="/?c=1_2">\u540c\u4eba</a></li><li><a href="/?c=2_1">\u5199\u771f</a></li><li><a href="/?c=2_2">\u89c6\u9891</a></li><li><a href="https://nyaa.si">nyaa</a></li>':'<li><a href="/?c=1_3&s=seeders&o=desc">Anime</a></li><li><a href="/?c=1_1&s=seeders&o=desc">AMV</a></li><li><a href="/?c=2_0&s=seeders&o=desc">Audio</a></li><li><a href="/?c=5_1&s=seeders&o=desc">Graphic</a></li><li><a href="/?c=5_2&s=seeders&o=desc">Photo</a></li><li><a href="/?c=6_1&s=seeders&o=desc">App</a></li><li><a href="/?c=6_2&s=seeders&o=desc">Game</a></li><li><a href="https://sukebei.nyaa.si">18X</a></li>',document.querySelector("a.navbar-brand").addEventListener("contextmenu",zset,false))}{function zproxy(){let xhr=unsafeWindow.XMLHttpRequest,ajax=url=>{let req=new xhr;return req.open("GET",url,false),req.send(),req.responseText};unsafeWindow.XMLHttpRequest=new Proxy(XMLHttpRequest,{construct(target){let iurl,body,fake;return new Proxy(new target,{set(target,prop,value){return target[prop]=value,true},get(target,prop,receiver){let value=target[prop];if("function"==typeof value)value=function(){switch(prop){case"open":iurl=arguments[1];break;case"send":body=arguments[0],iurl.includes("/proxyhttp")&&body.includes("vinfoad")&&(fake=ajax(pod.home+"/api/vitx?zbody="+encodeURIComponent(body)))}return target[prop].apply(target,arguments)};else if("response"==prop&&iurl.includes("/proxyhttp")){let d=JSON.parse(fake??value);d.hasOwnProperty("vinfo")?(d.vinfo=JSON.parse(d.vinfo),d.vinfo.report="",d.vinfo.preview=Number.parseInt(d.vinfo.vl.vi[0].td),d.vinfo.vl.vi[0].wl.wi=[],d.vinfo.fl.fi=d.vinfo.fl.fi.filter(t=>["fhd","shd"].includes(t.formatdefn)),d.vinfo.fl.cnt=d.vinfo.fl.fi.length,value=JSON.stringify({errCode:0,vinfo:JSON.stringify(d.vinfo)})):68==d?.code?u.dialog(pod.vli):d.hasOwnProperty("message")&&u.dialog(d.message)}return value}})}})}"v.qq.com"==location.hostname&&(GM_addStyle("#pc_client,.quick_games,.quick_vip,.vip-button,.txp-little-tip,.player-side-ads,.site_footer,.txp-watermark{display: none !important}"),u.hsave("__thumbplayer_setting__definition_vod","fhd"),location.pathname.startsWith("/x/cover/")?(zproxy(),u.domremove(["#ssi-footer"])):u.domhide(["#new_vs3_games","#new_vs3_banner1","#ad_qll_width1","#ad_qll_width2","#ad_qll_width3"]))}function idm(data){let a=[],b=[],id=data.videoDetails.videoId,ia={bitrate:0};if(data.streamingData.adaptiveFormats.forEach(t=>{if(t.hasOwnProperty("signatureCipher")&&(t.url=t.signatureCipher),t.url&&t.mimeType.includes("audio/")&&t.bitrate>ia.bitrate&&(ia={bitrate:t.bitrate,name:id+".mp3",summary:"\u97f3\u9891",url:t.url}),t.url&&t.mimeType.includes("video/")){let s=/p$/.test(t.qualityLabel)?t.qualityLabel+t.fps:t.qualityLabel;b.includes(s)||(b.push(s),t.mimeType.includes("video/webm")&&720<Number.parseInt(t.height)&&a.push({name:id+".mp4",summary:s,url:t.url}),t.mimeType.includes("video/mp4")&&360<Number.parseInt(t.height)&&a.push({name:id+".mp4",summary:s,url:t.url}))}}),a.length){a.push(ia),a.reverse();let dom=document.querySelector("#zydl");null==dom?pod.task=setInterval(()=>{if(document.querySelector("#meta-contents")){clearInterval(pod.task),document.querySelector("#meta-contents").insertAdjacentHTML("beforebegin",'<div id="zydl" class="btn-group outline"></div>');let dom=document.querySelector("#zydl");dom.innerHTML='<button name="zyset"><i class="ion-settings"></i> \u8bbe\u7f6e</button>'+u.tpl(pod.tpls.dlist,a),dom.setAttribute("style","font-size: 14px; margin-top: .5em"),dom.addEventListener("click",async()=>{let dom=u.zdom(1);if(null==dom.dataset.url)zset();else{let url=dom.dataset.url;if(!url.startsWith("http")){"function"!=typeof pod.decsign&&(pod.decsign=await fetch(document.querySelector('script[src$="base.js"]').src).then(r=>r.text()).then(str=>{str=str.replace(/\s+/g," ");let arr=/=(\w+?)\(decodeURIComponent/.exec(str),name=(arr=RegExp(`${arr[1]}=function\((.+?)\){(.+?)}`).exec(str))[1],body=arr[2];return arr=/;(.+?)\..+?\(/.exec(body),arr=RegExp(`var ${arr[1]}={.+?};`).exec(str),Function(name,arr[0]+body)}));let usp=u.usp(url);pod.decsign.call(null,usp.s)}u.aria2([{"all-proxy":pod.aria2.proxy,referer:"https://www.youtube.com/","user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36",url:[url],dir:pod.aria2.dir,out:dom.dataset.name,split:"16"}])}})}},1e3):dom.innerHTML='<button name="zyset"><i class="ion-settings"></i> \u8bbe\u7f6e</button>'+u.tpl(pod.tpls.dlist,a)}else{let dom=document.querySelector("#zydl");null!=dom&&(dom.innerHTML="")}}if("wallhaven.cc"==location.hostname&&(GM_addStyle("header.listing-header,header.thumb-listing-page-header{display:none}"),document.querySelector("#thumbs").addEventListener("click",e=>{if("preview"==e.target.className){let dom=u.zdom(1);fetch(dom.getAttribute("href")).then(r=>r.text()).then(d=>{GM_download(d.match(/<img id="wallpaper" src="(.+?)"/)[1],u.uid()+".jpg")})}})),"www.youtube.com"==location.hostname&&(pod.tpls={dlist:'<button data-name="[name]" data-url="[url]">[summary]</button>'},pod.defaults={dir:"C:/Users/Public/Downloads/youtube",jsonrpc:"http://127.0.0.1:16800/jsonrpc",token:"",proxy:"http://127.0.0.1:1081"},pod.aria2=u.load("aria2",pod.defaults),restAria2(),unsafeWindow.fetch=new Proxy(fetch,{apply:(target,obj,args)=>target.apply(obj,args).then(r=>("/watch"==location.pathname&&args[0]instanceof Request&&args[0].url.includes("player")&&r.clone().json().then(idm),r))}),"/watch"==location.pathname)&&idm(unsafeWindow.ytplayer.config.args.raw_player_response),"www.iqiyi.com"==location.hostname){function swQuality(){setTimeout(()=>{let dom=document.querySelector("[data-player-hook=vip_definition_5]");dom&&dom.parentElement.click()},1e3)}function vipdt(num){let d=new Date(num),o={year:d.getFullYear(),month:u.zero(1+d.getMonth()),date:u.zero(d.getDate())};return`${o.year}年${o.month}月${o.date}日`}function vipfake(){null!=unsafeWindow.playerObject&&(playerObject.package.ad.isVIP=true,playerObject.package.ad.vipCheckResult={isVIP:1,userVipType:1},0==pod.vi.tvid)&&playerObject.refresh()}function zproxy(){let xhr=unsafeWindow.XMLHttpRequest,ajax=url=>{let req=new xhr;return req.open("GET",url,false),req.send(),req.responseText};unsafeWindow.XMLHttpRequest=new Proxy(XMLHttpRequest,{construct(target){let iurl,body;return new Proxy(new target,{set(target,prop,value){return target[prop]=value,true},get(target,prop,receiver){let value=target[prop];if("function"==typeof value)value=function(){switch(prop){case"open":iurl=arguments[1];break;case"send":body=arguments[0]}return target[prop].apply(target,arguments)};else if("responseText"==prop)if(iurl.includes("/vip_users")){let x=1e3*(pod.now-9e4),y=1e3*(pod.now+9e5),sx=vipdt(x),sy=vipdt(y);if(value.length){let d=JSON.parse(value);Object.assign(d.data.vip_info,{autoRenew:"0",level:"1",paidSign:1,vipType:"1",payType:"0",status:"1",type:"1",surplus:"17",yearExpire:1,createTime:{t:x,date:sx},deadline:{t:y,date:sy},longestDeadline:{t:y,date:sy},superscript:"http://static-s.iqiyi.com/common/20220301/qiyue2.0/d1/fb/e443befcf4134667819f60edd1e4db996184486938097571652.png",longSuperscript:"http://static-s.iqiyi.com/common/20220301/qiyue2.0/69/55/b2a7b8af1c8f47ad99b1cb0ba9ed0ab97103194638013294000.png",vipTypeName:"\u9ec4\u91d1VIP\u4f1a\u5458",vipTypeGroup:"vip_info"}),value=JSON.stringify(d)}}else if(iurl.includes("/userinfodetail?")){let x=1e3*(pod.now-9e4),y=1e3*(pod.now+9e5),sx=vipdt(x),sy=vipdt(y);if(value.length){let d=JSON.parse(value);d.data.vipTypes="1",d.data.userInfo.activated=0,Object.assign(d.data.vipInfo,{autoRenew:"0",level:"1",paidSign:1,vipType:"1",payType:"0",status:"1",type:"1",surplus:"17",yearExpire:1,createTime:{t:x,date:sx},deadline:{t:y,date:sy},longestDeadline:{t:y,date:sy},superscript:"http://static-s.iqiyi.com/common/20220301/qiyue2.0/d1/fb/e443befcf4134667819f60edd1e4db996184486938097571652.png",longSuperscript:"http://static-s.iqiyi.com/common/20220301/qiyue2.0/69/55/b2a7b8af1c8f47ad99b1cb0ba9ed0ab97103194638013294000.png",vipTypeName:"\u9ec4\u91d1VIP\u4f1a\u5458",vipTypeGroup:"vip_info"}),value=JSON.stringify(d)}}else if(iurl.includes("/dash")){let tvid=u.strcut(iurl,"tvid=","&"),bid=Number.parseInt(u.strcut(iurl,"&bid=","&"));if(tvid==pod.vi.tvid)value=pod.vi.info;else{let d=JSON.parse(value);if(bid==pod.hd||d.data.hasOwnProperty("boss_ts")&&0==d.data.boss_ts.previewTime&&1==d.data.boss_ts.content.vipMode){if(null==pod.cipher){pod.cipher={};let arr=Object.keys(unsafeWindow.iqiyiPlayerJSONPCallback[0][1]);iqiyiPlayerJSONPCallback[0][1][arr[1]](null,pod.cipher)}let s,vf,dfp=u.strcut(iurl,"dfp=","&"),fake=(s=u.strcut(iurl,"iqiyi.com","&vf=").replace(/k_uid=\w+/,"k_uid="+pod.ui.kuid).replace(/pck=\w+/,"pck="+pod.ui.pck).replace(/uid=\w+/,"uid="+pod.ui.uid).replaceAll(dfp,pod.ui.dfp),vf=pod.cipher.mmc(s),pod.url=encodeURIComponent(`https://cache.video.iqiyi.com${s}&vf=${vf}`),ajax(`${pod.home}/api/vi271?vid=${tvid}&url=${pod.url}`));"A00000"===(d=JSON.parse(fake)).code?(value=fake,(bid==pod.hd?(pod.vi.tvid=tvid,pod.vi.info=value,vipfake):swQuality)()):68==d?.code?u.dialog(pod.vli):d.hasOwnProperty("message")&&u.dialog(d.message)}else swQuality()}}return value}})}}),unsafeWindow.fetch=new Proxy(fetch,{apply:(target,obj,args)=>target.apply(obj,args).then(r=>{let url=args[0]instanceof Request?args[0].url:args[0];return url.includes("iqiyi.com/videos/other/")&&(pod.itask1=0,pod.task1=setInterval(()=>{let dom=document.querySelector(".public-vip");null==dom||dom.parentElement.style.cssText.includes("display")?(pod.itask1++,9<pod.itask1&&clearInterval(pod.task1)):(clearInterval(pod.task1),vipfake(),dom.click())},500)),r})})}if(GM_addStyle(".qy-plist-ad,.qy-play-ad,.qy-side-head,.iqp-logo-box,.qy-player-side > div > .btn-wrap,.meta-cont > .btn-wrap,div[data-adzone]{display: none !important}"),pod.vi={tvid:0,info:null},document.cookie.includes("P00003=")){pod.usign=encodeURIComponent(JSON.stringify({uid:u.strcut(document.cookie,"P00003=",";"),cookie:document.cookie})),pod.ui=u.load("ui"),pod.latest=u.load("latest",0),pod.now>pod.latest&&fetch(`${pod.home}/api/ui271?usign=${pod.usign}&version=${pod.version}`).then(r=>r.json()).then(d=>{switch(d.code){case 69:GM_openInTab(d.message);break;case 0:pod.latest=pod.now+9e3,u.save("latest",pod.latest),pod.ui=d.data,u.save("ui",pod.ui)}});{function dp(name,hook,target){let tmp;Object.defineProperty(null==target?unsafeWindow:target,name,{configurable:true,enumerable:true,get:()=>tmp,set(val){tmp=hook.call(target,val)}})}function dphook(obj){return obj.hasOwnProperty("a")&&(obj.a._yunl="",obj.a.d=null,obj.a.status=0,obj.a.data.duration=0,obj.a.data.playUrls=[]),obj.hasOwnProperty("v")?(pod.hd=0,obj.v.vidl.forEach(t=>{t.isLimit=false,t.bid>pod.hd&&(pod.hd=t.bid)}),obj.v.vidl.filter(t=>t.bid==pod.hd)):pod.hd=600,obj}location.pathname.startsWith("/v_")&&(null==unsafeWindow.QiyiPlayerProphetData?dp("QiyiPlayerProphetData",dphook):QiyiPlayerProphetData=dphook(QiyiPlayerProphetData),zproxy(),pod.itask=0,pod.task=setInterval(()=>{let dom=document.querySelector(".open-vip");null==dom?(pod.itask++,9<pod.itask&&clearInterval(pod.task)):(clearInterval(pod.task),vipfake())},1e3))}}}if("pan.baidu.com"==location.hostname){function zproxy(){unsafeWindow.XMLHttpRequest=new Proxy(XMLHttpRequest,{construct(target){let iurl,body;return new Proxy(new target,{set(target,prop,value){return target[prop]=value,true},get(target,prop,receiver){let value=target[prop];if("function"==typeof value)value=function(){switch(prop){case"open":iurl=arguments[1];break;case"send":body=arguments[0]}return target[prop].apply(target,arguments)};else if("responseText"==prop&&iurl.includes("/api/quota")){let usp=new URLSearchParams(u.strcut(iurl,"?")),d=(pod.logid=usp.get("logid"),pod.dplogid=usp.get("dp-logid"),pod.bdstoken=usp.get("bdstoken"),null==pod.sign&&(pod.sign="invalid",fetch(`/api/gettemplatevariable?fields=${encodeURIComponent(JSON.stringify(["sign2","sign1","sign3","timestamp"]))}&channel=chunlei&web=1&app_id=250528&bdstoken=${pod.bdstoken}&logid=${pod.logid}&clienttype=0&dp-logid=${pod.dplogid}`).then(r=>r.json()).then(d=>{if(0==d.errno){pod.timestamp=d.result.timestamp;let foo=Function("return "+d.result.sign2)();pod.sign=btoa(foo(d.result.sign3,d.result.sign1))}else u.dialog("\u521d\u59cb\u5316\u8bfb\u53d6\u6570\u636e\u5931\u8d25 \u8bf7\u5237\u65b0\u4e00\u6b21\u9875\u9762")})),JSON.parse(value));d.total=0xc0000000000,d.free=d.total-d.used,value=JSON.stringify(d)}return value}})}})}function dscan(str){let xhr=new XMLHttpRequest,d=(xhr.open("GET","/rest/2.0/xpan/multimedia?method=listall&web=0&recursion=1&web=0&path="+encodeURIComponent(str),false),xhr.send(),JSON.parse(xhr.responseText));return 0!=d.errno&&(d.list=[]),d.list}function flink(){if(pod.wait)u.dialog("\u7a0d\u7b49\u4e00\u4e0b");else{let arr=pod.dcontext.instanceForSystem.list.getSelected().reduce((d,t)=>(t.isdir?d=d.concat(dscan(t.path)):d.push(t),d),[]);pod.len=arr.length,pod.len?(pod.wait=1,pod.icon.className="ion-refresh spinner",pod.path=pod.dcontext.instanceForSystem.list.getCurrentPath(),pod.idx=0,pod.li=[],arr.forEach(t=>{GM_xmlhttpRequest({url:"http://pcs.baidu.com/rest/2.0/pcs/file?method=download&app_id=250528&path="+encodeURIComponent(t.path),method:"HEAD",headers:{"User-Agent":"netdisk;4.24.0"},onload:function(r){GM_xmlhttpRequest({url:r.finalUrl,method:"GET",headers:{Range:"bytes=0-"+(t.size<262144?t.size-1:262143),"User-Agent":"netdisk;4.24.0"},responseType:"arraybuffer",onload:function(r){if(206==r.status){r.responseHeaders=r.responseHeaders.replace(/\s+/g," ");let mat=r.responseHeaders.match(/content-md5: ([\da-f]{32})/i);if(Array.isArray(mat)?t.a=mat[1]:(mat=r.responseHeaders.match(/etag: ([\da-f]{32})/i),t.a=Array.isArray(mat)?mat[1]:""),t.size<262144)t.b=t.a;else{let spark=new SparkMD5.ArrayBuffer;spark.append(r.response),t.b=spark.end()}pod.li.push([t.a,t.b,t.size,u.namefix(t.path.replace(pod.path,""))].join("#")),pod.idx++,pod.idx==pod.len&&(pod.wait=0,pod.icon.className="ion-flash",GM_setClipboard(pod.li.join("\r\n"),"text"))}else{pod.wait=0,pod.icon.className="ion-falsh";let dom=pod.icon.closest("button");"idm"!=dom.getAttribute("name")&&dom.setAttribute("name","idm")}}})}})})):u.dialog("\u672a\u52fe\u9009\u6587\u4ef6")}}function dlink(){if(pod.wait)u.dialog("\u7a0d\u7b49\u4e00\u4e0b");else{let arr=pod.dcontext.instanceForSystem.list.getSelected().reduce((d,t)=>(t.isdir?d=d.concat(dscan(t.path)):d.push(t),d),[]);if(arr.length){let li=arr.filter(t=>!t.isdir).map(t=>t.fs_id),body={sign:pod.sign,timestamp:pod.timestamp,fidlist:JSON.stringify(li),type:"dlink",vip:0,channel:"chunlei",web:1,app_id:"250528",bdstoken:pod.bdstoken,logid:pod.logid,jsToken:pod.jstoken,clienttype:0,"dp-logid":pod.dplogid};fetch(`/api/download?${u.serialize(body)}`).then(r=>r.json()).then(d1=>{0===d1.errno?(pod.len=d1.dlink.length,fetch(`${pod.home}/api/nubaidu?version=${pod.version}&usign=${pod.usign}`).then(r=>r.json()).then(d2=>{0==d2.code?d2.data>pod.len?(pod.wait=1,pod.icon.className="ion-refresh spinner",pod.idx=0,d1.dlink.forEach(t1=>{let fe,idx=arr.findIndex(t2=>t1.fs_id==t2.fs_id);fe={dlink:t1.dlink,path:arr[idx].path,size:arr[idx].size},fetch(`${pod.home}/api/dlinkbaidu?fe=${encodeURIComponent(JSON.stringify(fe))}&usign=${pod.usign}`).then(r=>r.json()).then(d=>{pod.idx++,pod.idx==pod.len&&(pod.wait=0,pod.icon.className="ion-download"),0===d.code&&d.data.url.length&&(d.data.dir=pod.aria2.dir,u.aria2([d.data]))})})):u.dialog("\u8bf7\u6253\u5f00\u70b9\u8d5e\u5217\u8868\u7ed9\u5176\u4e2d\u7684\u89c6\u9891\u70b9\u8d5e\u83b7\u53d6\u66f4\u591a\u4f7f\u7528\u6b21\u6570"):u.dialog(""+d2.message)})):u.dialog(d1.errmsg)})}else u.dialog("\u672a\u52fe\u9009\u6587\u4ef6")}}function zyminit(){pod.zym={num:0,size:0,path:"/"},document.querySelector("#layoutApp").insertAdjacentHTML("beforeend",'<div id="zym"><div class="btn-group outline full"><button name="fnew"><i class="ion-instagram"></i> \u65b0\u5efa</button><button name="frm"><i class="ion-close-circle-outline"></i> \u5220\u9664</button><button name="fin"><i class="ion-log-in"></i> \u5b58\u5165</button><button name="fout"><i class="ion-log-out"></i> \u53d6\u51fa</button></div><div style="text-align: right">\u5df2\u7528\u5bb9\u91cf\uff1a <span name="usize">0</span> &nbsp; </div><div name="path"></div><div name="full"><table><thead><tr><td width="36"></td><td></td><td width="72"></td></tr></thead><tbody id="fli"></tbody></table></div></div>');let dom=document.querySelector("#zym > div[name=full]");dom.style.cssText="height:"+(Math.min(document.body.scrollHeight,window.innerHeight)-dom.offsetTop)+"px",document.querySelector("#fli").addEventListener("click",()=>{let dom=u.zdom(1);pod.checkbox=dom.parentElement,1===dom.cellIndex&&0==pod.checkbox.dataset.fid?zymfli(pod.zym.path+dom.textContent+"/"):u.swClassName("on")}),document.querySelector("#zym > div.btn-group").addEventListener("click",()=>{let arr=[],fli=JSON.parse(u.hread("fli","[]"));switch(u.zdom(1),"I"==dom.tagName&&(dom=dom.parentElement),pod.icon=dom.children[0],dom.getAttribute("name")){case"fnew":document.querySelector("#fli").insertAdjacentHTML("afterbegin",'<tr data-fid="0"><td></td><td><input name="filename" type="text" placeholder="\u8bf7\u8f93\u5165\u6587\u4ef6\u5939\u540d\u79f0"></td><td></td></tr>');let dom=document.querySelector("#fli input");dom.focus(),dom.addEventListener("keypress",e=>{if(13==e.charCode){let s=u.namefix(e.target.value);s.length<3?e.target.closest("tr").remove():fetch(`${pod.home}/api/fnew?usign=${pod.usign}&path=${pod.zym.path}&name=${s}`).then(r=>r.json()).then(d=>{let dom=e.target.parentElement;if(0==d.code){e.target.remove(),dom.innerText=s,dom.parentElement.dataset.id=d.data;let arr=JSON.parse(localStorage.getItem("fli"));arr.push({id:d.data,fid:0,fsize:"",name:s,path:pod.zym.path,size:0}),localStorage.setItem("fli",JSON.stringify(arr))}else dom.remove()})}});break;case"frm":document.querySelectorAll("#zym tr.on").forEach(t1=>{if(arr.push(Number.parseInt(t1.dataset.id)),"0"==t1.dataset.fid){let folder=t1.children[1].textContent,path="/"==pod.zym.path?"/"+folder:""+pod.zym.path+folder;fli.forEach(t2=>{t2.path.startsWith(path)&&arr.push(Number.parseInt(t2.id))})}}),arr.length&&fetch(`${pod.home}/api/frm?li=${JSON.stringify(arr)}&usign=${pod.usign}`).then(r=>r.json()).then(d=>{0==d.code&&(fli=fli.filter(t=>!arr.includes(t.id)),u.hsave("fli",JSON.stringify(fli)),pod.zym.size=0,fli.forEach(t=>{pod.zym.size+=Math.ceil(t.size/1e6)}),document.querySelector("span[name=usize]").innerText=u.fsize(pod.zym.size,2),zymfli(pod.zym.path))});break;case"fin":if(pod.wait)u.dialog("\u7a0d\u7b49\u4e00\u4e0b");else{let arr=pod.dcontext.instanceForSystem.list.getSelected().reduce((d,t)=>(t.isdir?d=d.concat(dscan(t.path)):d.push(t),d),[]);pod.len=arr.length,0==pod.len?u.dialog("\u6ca1\u6709\u52fe\u9009\u6587\u4ef6"):pod.len<50?(pod.wait=1,pod.icon.className="ion-refresh spinner",pod.idx=0,pod.path=pod.dcontext.instanceForSystem.list.getCurrentPath(),pod.fail=[],pod.li=[],arr.forEach(t=>{GM_xmlhttpRequest({url:"http://pcs.baidu.com/rest/2.0/pcs/file?method=download&app_id=250528&path="+encodeURIComponent(t.path),method:"HEAD",headers:{"User-Agent":"netdisk;4.24.0"},onerror:function(){pod.idx++,pod.fail.push(t.server_filename)},onload:function(r){GM_xmlhttpRequest({url:r.finalUrl,method:"GET",headers:{Range:"bytes=0-"+(t.size<262144?t.size-1:262143),"User-Agent":"netdisk;4.24.0"},responseType:"arraybuffer",onerror:function(){pod.idx++,pod.fail.push(t.server_filename)},onload:function(r){if(206==r.status){let b,a=r.responseHeaders.match(/content-md5: ([\da-f]{32})/i)[1],spark=new SparkMD5.ArrayBuffer;if(b=t.size<262144?a:(spark.append(r.response),spark.end()),pod.li.push({a:a,b:b,fid:t.fs_id,size:t.size,name:t.server_filename,path:(pod.zym.path+t.path.replace(pod.path,"").replace(t.server_filename,"")).replaceAll("//","/")}),pod.idx++,pod.idx==pod.len){if(pod.fail.length){let s=pod.fail.join("<br>");u.dialog("\u4e0b\u5217\u6587\u4ef6\u5165\u5e93\u5931\u8d25\uff0c\u8bf7\u5c1d\u8bd5\u5355\u72ec\u64cd\u4f5c\u6216\u8005\u68c0\u67e5\u81ea\u5df1\u7684\u7f51\u7edc\u662f\u5426\u7a33\u5b9a\u3002<br><br>"+s)}let arr=pod.li.map(t=>t.path).filter((t,idx,self)=>self.indexOf(t)==idx).filter(t=>t!=pod.zym.path).map(t=>t.slice(0,-1)).map(t=>{let idx=1+t.lastIndexOf("/");return{fid:0,name:t.slice(idx),path:t.slice(0,idx)}});pod.li=pod.li.concat(arr),fetch(pod.home+"/api/fin?usign="+pod.usign,{method:"POST",mode:"cors",credentials:"omit",body:JSON.stringify(pod.li)}).then(r=>r.json()).then(d=>{pod.wait=0,pod.icon.className="ion-log-in",fetch(pod.home+"/api/fli?usign="+pod.usign).then(r=>r.json()).then(d=>{if(0==d.code){pod.zym.size=0;let arr=d.data.map(t=>(t.size=Number.parseInt(t.size),pod.zym.size+=Math.ceil(t.size/1e6),t.fsize=u.fsize(t.size,0),t));u.hsave("fli",JSON.stringify(arr)),document.querySelector("span[name=usize]").innerText=u.fsize(pod.zym.size,2),zymfli(pod.zym.path)}})})}}else pod.idx++,pod.fail.push(t.server_filename)}})}})})):u.dialog("\u52fe\u9009\u7684\u6587\u4ef6\u6570\u91cf\u8fc7\u591a<br>\u8bf7\u63a7\u5236\u6570\u91cf50\u4ee5\u5185")}break;case"fout":if(pod.wait)u.dialog("\u6b63\u5728\u6267\u884c\u4efb\u52a1\u4e2d");else if(pod.path=pod.dcontext.instanceForSystem.list.getCurrentPath(),document.querySelectorAll("#zym tr.on").forEach(t1=>{let fid=t1.dataset.fid,name=t1.children[1].textContent;if(0==fid){let path=""+pod.zym.path+name+"/";fli.forEach(t2=>{t2.path.startsWith(path)&&arr.push({id:t2.id,fid:t2.fid,name:pod.path+t2.path.replace(pod.zym.path,"/")+t2.name})})}else arr.push({id:t1.dataset.id,fid:fid,name:pod.path+"/"+name})}),(arr=arr.filter(t=>0!=t.fid)).length){pod.wait=1,pod.icon.className="ion-refresh spinner";let li=JSON.stringify(arr.map(t=>t.id));fetch(`${pod.home}/api/fout?li=${li}&usign=${pod.usign}`).then(r=>r.json()).then(d=>{if(0==d.code){let idx=0,len=d.data.length,list=[],h={"User-Agent":"LogStatistic","Content-Type":"application/x-www-form-urlencoded"};pod.idx=0,pod.len=d.data.length,d.data.map(t1=>{let idx=arr.findIndex(t2=>t2.fid==t1.fid),body=(-1!=idx&&(t1.name=arr[idx].name.replaceAll("//","/")),{rtype:0,path:t1.name,"content-length":t1.size,"content-md5":t1.a,"slice-md5":t1.b});return body}).forEach(t=>{fetch(`/api/rapidupload?bdstoken=${pod.bdstoken}`,{method:"POST",headers:h,body:u.serialize(t)}).then(r=>r.json()).then(d=>{0!=d.errno&&list.push(t),idx++,len==idx&&(idx=0,list.length?(len=list.length,list.map(t=>(t["content-md5"]=t["content-md5"].toUpperCase(),t["slice-md5"]=t["slice-md5"].toUpperCase(),t)).forEach(t=>{fetch(`/api/rapidupload?bdstoken=${pod.bdstoken}`,{headers:h,method:"POST",body:u.serialize(t)}).then(r=>r.json()).then(d=>{idx++,len==idx&&(pod.wait=0,pod.icon.className="ion-log-out",pod.dmessage.trigger("system-refresh"))})})):(pod.wait=0,pod.icon.className="ion-log-out",pod.dmessage.trigger("system-refresh")))})})}else pod.wait=0,pod.icon.className="ion-log-out",u.dialog(d.message)})}}}),document.querySelector("#zym > div[name=path]").addEventListener("click",()=>{let dom=u.zdom(1);"SPAN"==dom.tagName&&zymfli(dom.dataset.path)}),fetch(pod.home+"/api/fli?usign="+pod.usign).then(r=>r.json()).then(d=>{if(0==d.code){let arr=d.data.map(t=>(t.size=Number.parseInt(t.size),t.fsize=u.fsize(t.size,0),pod.zym.size+=Math.ceil(t.size/1e6),t));u.hsave("fli",JSON.stringify(arr)),document.querySelector("span[name=usize]").innerText=u.fsize(pod.zym.size,2),zymfli("/")}})}function zymfli(str){pod.zym.path=str.replaceAll("//","/");let a,b="",s='<span data-path="/">root</span>';if(1<pod.zym.path.length){let arr=pod.zym.path.split("/").slice(1).map(t=>(b+="/"+t,a=t.replaceAll(/\s+/g,"").slice(0,6),`<span data-path="${b}/">${a}</span>`));3<arr.length&&(arr=arr.slice(arr.length-3)),s+=arr.join("")}document.querySelector("#zym > div[name=path]").innerHTML=s;let arr=JSON.parse(u.hread("fli","[]")).filter(t=>t.path==pod.zym.path);arr.length?(arr.sort((a,b)=>a.name>b.name?1:b.name>a.name?-1:0).sort((a,b)=>0!=a.size&&0==b.size?1:0),document.querySelector("#fli").innerHTML=u.tpl(pod.tpl.fli,arr)):document.querySelector("#fli").innerHTML=""}function zymsw(){let dom1=document.querySelector("#layoutMain"),dom2=(null!=dom1&&(dom1.style.cssText="width:"+(dom1.offsetWidth-430)+"px"),document.querySelector("#zym"));null==dom2?zyminit():dom2.style.cssText="display: block"}function ulist(){let dom=document.createElement("ul"),hs=(dom.className="ulist",dom.addEventListener("click",e=>{if(e.preventDefault(),e.stopPropagation(),0==pod.wait){pod.wait=1;let s=e.target.closest("li").dataset.name;if("new"==s)GM_cookie.list({domain:".baidu.com"},(r,e)=>{e||r.forEach(t=>{GM_cookie.delete({name:t.name},e=>{})}),setTimeout(()=>{pod.wait=0,location.href="//pan.baidu.com/login"},2e3)});else{let i,arr=u.load("ulist",[]);-1==(i=arr.findIndex(t=>t.uid==s))?GM_cookie.list({domain:".baidu.com"},(r,e)=>{e||r.forEach(t=>{GM_cookie.delete({name:t.name},e=>{})}),setTimeout(()=>{pod.wait=0,location.href="//pan.baidu.com/login"},2e3)}):(arr[i].scookie.forEach((t,idx)=>{GM_cookie.set(t,e=>{})}),location.href.includes("path=%2F&")||(location.hash="/all?path=%2F"),setTimeout(()=>{pod.wait=0,location.reload()},2e3))}}}),'<li data-name="new"><svg xmlns="http://www.w3.org/2000/svg" width="72" height="72" fill="#999" class="bi bi-plus-square-dotted" viewBox="0 0 16 16"><path d="M2.5 0c-.166 0-.33.016-.487.048l.194.98A1.51 1.51 0 0 1 2.5 1h.458V0H2.5zm2.292 0h-.917v1h.917V0zm1.833 0h-.917v1h.917V0zm1.833 0h-.916v1h.916V0zm1.834 0h-.917v1h.917V0zm1.833 0h-.917v1h.917V0zM13.5 0h-.458v1h.458c.1 0 .199.01.293.029l.194-.981A2.51 2.51 0 0 0 13.5 0zm2.079 1.11a2.511 2.511 0 0 0-.69-.689l-.556.831c.164.11.305.251.415.415l.83-.556zM1.11.421a2.511 2.511 0 0 0-.689.69l.831.556c.11-.164.251-.305.415-.415L1.11.422zM16 2.5c0-.166-.016-.33-.048-.487l-.98.194c.018.094.028.192.028.293v.458h1V2.5zM.048 2.013A2.51 2.51 0 0 0 0 2.5v.458h1V2.5c0-.1.01-.199.029-.293l-.981-.194zM0 3.875v.917h1v-.917H0zm16 .917v-.917h-1v.917h1zM0 5.708v.917h1v-.917H0zm16 .917v-.917h-1v.917h1zM0 7.542v.916h1v-.916H0zm15 .916h1v-.916h-1v.916zM0 9.375v.917h1v-.917H0zm16 .917v-.917h-1v.917h1zm-16 .916v.917h1v-.917H0zm16 .917v-.917h-1v.917h1zm-16 .917v.458c0 .166.016.33.048.487l.98-.194A1.51 1.51 0 0 1 1 13.5v-.458H0zm16 .458v-.458h-1v.458c0 .1-.01.199-.029.293l.981.194c.032-.158.048-.32.048-.487zM.421 14.89c.183.272.417.506.69.689l.556-.831a1.51 1.51 0 0 1-.415-.415l-.83.556zm14.469.689c.272-.183.506-.417.689-.69l-.831-.556c-.11.164-.251.305-.415.415l.556.83zm-12.877.373c.158.032.32.048.487.048h.458v-1H2.5c-.1 0-.199-.01-.293-.029l-.194.981zM13.5 16c.166 0 .33-.016.487-.048l-.194-.98A1.51 1.51 0 0 1 13.5 15h-.458v1h.458zm-9.625 0h.917v-1h-.917v1zm1.833 0h.917v-1h-.917v1zm1.834-1v1h.916v-1h-.916zm1.833 1h.917v-1h-.917v1zm1.833 0h.917v-1h-.917v1zM8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3v-3z"></svg></li>');u.load("ulist",[]).filter(t=>t.uid!=pod.ui.uid).forEach(t=>{hs+=`<li data-name="${t.uid}"><img width="72" title="${t.monicker}" src="${t.avatar}"></li>`}),dom.insertAdjacentHTML("beforeend",hs),u.dialog(dom)}function uadd(){let arr=u.load("ulist",[]).filter(t=>u.vobj(t));if(arr.length){let i=arr.findIndex(t=>t.uid==pod.ui.uid);-1==i?arr.push(pod.ui):arr.splice(i,1,pod.ui)}else arr.push(pod.ui);u.save("ulist",arr)}if(GM_addStyle('#layoutMain{font-size:14px}div.file-name{font-family:"Microsoft YaHei UI", monospace}.wp-side-options,span.newIcon,span[node-type=find-apps],dd.desc-box>div{display:none !important}'),pod.msg={init:'HD2A\u5728\u767e\u5ea6\u7f51\u76d8\u521d\u59cb\u5316\u5931\u8d25<br>1. \u9700\u8981\u642d\u914d\u7be1\u6539\u7334Beta\u7248\u4f7f\u7528 <a href="https://www.tampermonkey.net/" target="_blank">Tampermonkey BETA</a><br>2. \u9700\u8981\u5e72\u51c0\u7684\u539f\u7248 Firefox / Chrome \u6d4f\u89c8\u5668<br>\u7531\u4e8e\u67d0\u4e9b\u8f6f\u4ef6\u4f1a\u6084\u6084\u7be1\u6539\u6d4f\u89c8\u5668\u5bfc\u81f4\u4e00\u4e9b\u95ee\u9898\uff0c\u5efa\u8bae\u5355\u72ec\u5b89\u88c5\u8f83\u4e3a\u5c0f\u4f17\u7684 <a href="https://www.mozilla.org/en-US/firefox/new/" target="_blank">Mozilla Firefox</a> \u6765\u4f7f\u7528\uff0c\u6ce8\u610f\u4e0d\u662f<span style="color: red">\u5317\u4eac\u8c0b\u667a</span>\u7684\u706b\u72d0\u6d4f\u89c8\u5668\u3002',timeout:"\u8bbf\u95eeHD2A\u89e3\u6790\u670d\u52a1\u5668\u5931\u8d25"},pod.tpl={fli:'<tr data-id="[id]" data-fid="[fid]"><td></td><td>[name]</td><td>[fsize]</td></tr>'},pod.defaults={dir:"C:/Users/Public/Downloads/baiduyun",jsonrpc:"http://127.0.0.1:16800/jsonrpc",token:""},pod.aria2=u.load("aria2",pod.defaults),restAria2(),"/disk/clear"==location.pathname)null!=unsafeWindow.locals&&(locals.set("is_vip",1),locals.set("is_svip",1),locals.set("vip_level",3));else if("/disk/home"==location.pathname)zproxy(),new MutationObserver((list,obs)=>{list.forEach(t=>{switch(t.target.getAttribute("node-type")){case"header-union":t.target.remove();break;case"header-apps":obs.disconnect(),t.addedNodes.forEach((dom,idx)=>{if(0==idx){let i=dom.cloneNode(true);i.children.forEach((t,idx)=>{idx<2||t.remove()}),i.childElementCount<3||i.children[2].remove(),i.style.cssText="cursor: default",i.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),ulist()}),i.addEventListener("contextmenu",e=>{e.preventDefault(),e.stopPropagation(),GM_openInTab("https://passport.baidu.com/center")}),t.target.prepend(i)}[3,5].includes(idx)||dom.remove()});let dom=document.querySelector("#layoutMain .menu");dom&&(dom.insertAdjacentHTML("beforeend",'<span class="g-button-menu" style="cursor: default"><i class="ion-flash"></i> \u79d2\u4f20\u7801</span>'),dom.lastChild.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation();let dom=document.createElement("form");dom.innerHTML='<textarea name="links" cols="50" rows="7" placeholder="\u5927\u6587\u4ef6\u6216\u8005\u77ed\u94fe\u5927\u6982\u7387\u65e0\u6548 \u6bcf\u884c\u4e00\u4e2a\u6587\u4ef6"></textarea><div class="btn-group"><button type="button"><i class="ion-close"></i> \u53d6\u6d88</button><button type="submit"><i class="ion-checkmark"></i> \u786e\u5b9a</button></div>',dom.addEventListener("submit",e=>{e.preventDefault(),e.stopPropagation();let body=new FormData(e.target),arr=body.get("links").replaceAll(/\0x0d/g,"").split("\n").map(t=>t.split("#")).filter(t=>4==t.length);if(arr.length){let idx=0,len=arr.length,list=[],path=pod.dcontext.instanceForSystem.list.getCurrentPath(),h={"User-Agent":"LogStatistic","Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"};arr.map(t=>{let body={type:0,"content-md5":t[0].toLowerCase(),"slice-md5":t[1].toLowerCase(),"content-length":t[2],path:(path+"/"+t[3]).replaceAll("//","/")};return body}).forEach(t=>{fetch(`/api/rapidupload?bdstoken=${pod.bdstoken}`,{headers:h,method:"POST",body:u.serialize(t)}).then(r=>r.json()).then(d=>{0!=d.errno&&list.push(t),idx++,len==idx&&(idx=0,list.length?(len=list.length,list.map(t=>(t["content-md5"]=t["content-md5"].toUpperCase(),t["slice-md5"]=t["slice-md5"].toUpperCase(),t)).forEach(t=>{fetch(`/api/rapidupload?bdstoken=${pod.bdstoken}`,{headers:h,method:"POST",body:u.serialize(t)}).then(r=>r.json()).then(d=>{idx++,len==idx&&pod.dmessage.trigger("system-refresh")})})):pod.dmessage.trigger("system-refresh"))})})}else u.dialog("\u79d2\u4f20\u7801\u683c\u5f0f\u9519\u8bef")}),dom.querySelector("button").addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),document.querySelector("#liveDialog").close()}),dom.querySelector("textarea").addEventListener("focus",e=>{e.preventDefault(),e.stopPropagation(),e.target.value=""}),u.dialog(dom)})),(dom=document.querySelector("div[node-type=listTopTools]"))&&(dom.innerHTML='<div class="btn-group outline" style="font-size: 12.5px"><button name="zspace"><i class="ion-paw"></i> \u6b21\u5143\u95e8</button><button name="video"><i class="ion-heart"></i> \u70b9\u8d5e</button><button name="zset"><i class="ion-settings"></i> \u8bbe\u7f6e</button><button name="yun"><i class="ion-paper-plane"></i> \u8d44\u6e90\u5e93</button><button name="share"><i class="ion-share"></i> \u5206\u4eab</button><button name="flink"><i class="ion-flash"></i> \u79d2\u4f20</button><button name="dlink"><i class="ion-download"></i> \u4e0b\u8f7d</button></div>',document.querySelector("div.btn-group.outline").addEventListener("click",()=>{let dom=u.zdom(1).closest("button");switch(dom.getAttribute("name")){case"share":let iform=document.createElement("form");iform.addEventListener("submit",e=>{e.preventDefault(),e.stopPropagation();let d=new FormData(e.target);d.append("uid",pod.ui.uid),d.append("cookie",pod.ui.cookie),fetch(`${pod.home}/api/baiduyun`,{method:"POST",mode:"cors",credentials:"same-origin",body:JSON.stringify(Object.fromEntries(d.entries()))}).then(r=>r.json()).then(d=>{e.target.reset()})}),iform.method="dialog",iform.innerHTML='<label>\u6807\u9898 <input name="title" type="text" maxlength="60" placeholder="\u965060\u5b57\u5185" required></label> <div class="inline"> <div>\u7c7b\u522b</div> <label><input name="catalog" type="radio" value="bangumi" checked> \u52a8\u6f2b</label> <label><input name="catalog" type="radio" value="film"> \u5f71\u89c6</label> <label><input name="catalog" type="radio" value="app"> \u8f6f\u4ef6</label> <label><input name="catalog" type="radio" value="book"> \u4e66\u7c4d</label> <label><input name="catalog" type="radio" value="video"> \u89c6\u9891</label> <label><input name="catalog" type="radio" value="other"> \u5176\u4ed6</label> </div> <textarea name="tag" maxlength="120" rows="3" wrap="soft" placeholder="\u9650120\u5b57 \u52a1\u5fc5\u586b\u5199\u6b63\u786e\u7684\u6807\u7b7e \u7528\u7a7a\u683c\u5206\u9694\u7684\u4e0e\u5185\u5bb9\u76f8\u5173\u7684\u4e00\u7ec4\u5173\u952e\u8bcd \u6807\u7b7e \u6807\u7b7e \u6807\u7b7e \u522b\u5f04\u9519\u4e86\u4e5f\u522b\u4e71\u5199 \u8fd9\u5f88\u91cd\u8981 \u4e71\u641e\u5c31\u62c9\u9ed1" required></textarea> <div> <div>\u79d2\u4f20\u4ee3\u7801</div> <textarea name="pack" rows="5" wrap="soft" placeholder="\u6bcf\u884c\u4e00\u6761\u79d2\u4f20\u4ee3\u7801" required></textarea> </div> <div class="btn-group"> <button type="button"> <i class="ion-close"></i> \u53d6\u6d88 </button> <button type="submit"> <i class="ion-checkmark"></i> \u786e\u5b9a </button> </div> <div style="width: 32em"> \u4ee5\u79d2\u4f20\u7801\u7684\u65b9\u5f0f\u5206\u4eab\u5230\u8d44\u6e90\u5e93\u4e2d\uff0c\u4ee5\u540e\u5927\u5bb6\u90fd\u53ef\u4ee5\u6253\u5f00\u8d44\u6e90\u5e93\u641c\u7d22\u63d0\u53d6\u5230\u81ea\u5df1\u7684\u7f51\u76d8\u4e0a\u8fdb\u884c\u4e0b\u8f7d\u3002\u7531\u4e8e\u767e\u5ea6\u7f51\u76d8\u5b98\u65b9\u7684\u9650\u5236\uff0c20G\u4ee5\u4e0a\u7684\u6587\u4ef6\u65e0\u6cd5\u4ee5\u79d2\u4f20\u4ee3\u7801\u8f6c\u5b58\uff0c\u88ab\u548c\u8c10\u6216\u6e05\u7406\u7684\u6587\u4ef6\u5176\u79d2\u4f20\u7801\u4e5f\u4f1a\u5931\u6548\uff0c\u4f46\u603b\u7684\u6765\u8bf4\u8fd8\u662f\u6bd4\u5e73\u53f0\u7684\u90a3\u4e2a\u8d44\u6e90\u5206\u4eab\u65b9\u5f0f\u8981\u597d\u7528\u3002<br> \u52fe\u9009\u6587\u4ef6\u70b9\u51fb\u79d2\u4f20\u6309\u94ae\u5c31\u80fd\u83b7\u53d6\u76f8\u5e94\u7684\u79d2\u4f20\u7801\uff0c\u81ea\u52a8\u5b58\u5165\u7cfb\u7edf\u526a\u8d34\u677f\uff0c\u53efctrl+v\u76f4\u63a5\u7c98\u8d34\u5728\u79d2\u4f20\u4ee3\u7801\u7684\u6587\u672c\u6846\u4e2d\u5373\u53ef\u3002 </div>',iform.querySelector("button[type=button]").addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),document.querySelector("#liveDialog").close()}),u.dialog(iform);break;case"yun":u.dialog("\u8d44\u6e90\u5e93\u5c1a\u5728\u5236\u4f5c\u4e2d<br>\u5206\u4eab\u6587\u4ef6\u6765\u83b7\u53d6\u8d44\u6e90\u5e93\u4f7f\u7528\u6b21\u6570\uff0c\u6682\u5b9a\u89c4\u5219\u5982\u4e0b\uff1a<br>\u4e0b\u8f7d\u4e00\u6b21 &nbsp; +1<br>\u70b9\u8d5e\u4e00\u6b21 &nbsp; +10<br>\u70b9\u8e29\u4e00\u6b21 &nbsp; -10<br>\u8fd9\u662f\u4e3a\u4e86\u4fdd\u969c\u8d44\u6e90\u5e93\u7684\u8d28\u91cf\uff0c\u4f17\u4eba\u62fe\u67f4\u706b\u7130\u9ad8\u3002<br>\u5927\u5bb6\u53ef\u4ee5\u5148\u5206\u4eab\u8d44\u6e90\uff0c\u7b49\u79ef\u7d2f\u5230\u4e00\u5b9a\u7a0b\u5ea6\u6216\u8bb8\u4e5f\u5236\u4f5c\u5b8c\u6210\u4e86\uff0c\u5230\u65f6\u6b63\u5f0f\u5f00\u653e\u3002");break;case"zspace":dom.hasAttribute("style")?(dom.removeAttribute("style"),document.querySelector("#layoutMain").removeAttribute("style"),document.querySelector("#zym").style.cssText="display: none"):(dom.style.cssText="color:#fff;background-color:#09aaff;border-color:#09aaff",zymsw());break;case"video":0==pod.wait&&(pod.wait=1,fetch(`${pod.home}/api/nubaidu?version=${pod.version}&usign=${pod.usign}`).then(r=>r.json()).then(d=>{if((pod.wait=0)==d.code)if(null==pod.vli)u.dialog("\u8bf7\u6309F5\u5237\u65b0\u9875\u9762<br>\u5982\u679c\u5f39\u51fa\u65b0\u7a97\u53e3\u8bf7\u67e5\u770b\u5176\u5185\u5bb9 \u4e00\u822c\u662f\u811a\u672c\u8981\u6c42\u66f4\u65b0");else{let dom=pod.vli.querySelector("span[name=uut]");dom&&(dom.textContent=d.data,u.dialog(pod.vli.cloneNode(true)))}else u.dialog(d.message)}));break;case"zset":zset();break;case"flink":pod.icon=dom.children[0],flink();break;case"idm":u.dialog("\u8bf7\u5148\u5173\u95ed\u5176\u4ed6\u6269\u5c55\u7684\u6355\u83b7\u6d4f\u89c8\u5668\u4e0b\u8f7d\uff0c\u5982idm \u8fc5\u96f7\u7b49\u4e0b\u8f7d\u8f6f\u4ef6\u53ef\u5728\u8bbe\u7f6e\u91cc\u5173\u95ed\u76f8\u5173\u9009\u9879<br>\u811a\u672c\u5728\u89e3\u6790\u94fe\u63a5\u4e4b\u524d\u4f1a\u8c03\u7528\u6d4f\u89c8\u5668\u4e0b\u8f7d\u4e00\u5c0f\u6bb5\u6587\u4ef6\u6570\u636e\u521d\u6b65\u9a8c\u8bc1\u8be5\u6587\u4ef6\u662f\u5426\u53ef\u6b63\u5e38\u4e0b\u8f7d<br>\u5982\u679c\u88ab\u5176\u4ed6\u6269\u5c55\u62e6\u622a\u540e\u811a\u672c\u65e0\u6cd5\u8fdb\u884c\u6b64\u9a8c\u8bc1\u4e5f\u5c31\u4e0d\u80fd\u6b63\u5e38\u8fd0\u884c");break;default:pod.icon=dom.children[0],dlink()}}))}})}).observe(document.querySelector("#layoutHeader"),{childList:true,subtree:true}),fetch("/rest/2.0/xpan/nas?method=uinfo").then(r=>r.json()).then(d=>{0==d.errno?(pod.ui={uid:d.uk,avatar:d.avatar_url,monicker:d.baidu_name},GM_cookie.list({domain:".baidu.com"},(r,e)=>{e?u.dialog(e):(pod.ui.cookie=(Array.isArray(r)&&r.length?u.cclean(r):[]).join(";"),pod.ui.cookie.includes("BDUSS")?(fetch(`${pod.home}/api/vlike?version=${pod.version}`).then(r=>r.json()).then(d=>{switch(d.code){case 69:GM_openInTab(d.message);break;case 0:pod.vli=document.createElement("div"),pod.vli.insertAdjacentHTML("beforeend",'<div style="padding-bottom: 10px">\u7ed9\u4e0b\u9762\u7684\u89c6\u9891\u70b9\u8d5e\u53ef\u83b7\u5f97\u4f7f\u7528\u6b21\u6570 &nbsp; \u4f60\u73b0\u5728\u7684\u53ef\u7528\u6b21\u6570\uff1a<span name="uut"></span> &nbsp; \u4ea4\u6d41\u7fa4\uff1a9767950</div><ul class="vlist"></ul>'),pod.vli.querySelector("ul.vlist").insertAdjacentHTML("afterbegin",u.tpl('<li><a href="https://www.bilibili.com/video/[bvid]" target="_blank" referrerpolicy="no-referrer"><img width="160" src="[pic]@160w_100h_1c.webp" crossorigin="anonymous" referrerpolicy="no-referrer"><div class="title">[title]</div></a></li>',d.data));break;default:u.dialog(d.message+" \u8bf7\u5c1d\u8bd5\u5237\u65b0\u9875\u9762")}}),pod.ui.uid!=GM_getValue("bduid",0)&&GM_setValue("bduid",pod.ui.uid),pod.usign=encodeURIComponent(JSON.stringify({uid:pod.ui.uid,cookie:pod.ui.cookie})),pod.dcontext=unsafeWindow.require("system-core:context/context.js"),pod.dmessage=unsafeWindow.require("system-core:system/baseService/message/message.js"),pod.ui.scookie=r,uadd(),pod.jstoken=unsafeWindow.jsToken,unsafeWindow.locals&&(locals.set("is_vip",1),locals.set("is_svip",1),locals.set("vip_level",8))):u.dialog(pod.msg.init))})):u.dialog(d.errmsg)});else if("/disk/main"==location.pathname&&location.hash.startsWith("#/index")){let s=u.strcut(location.hash,"path=","&");location.href="//pan.baidu.com/disk/home?stayAtHome=true#/all?path="+s}}else{let now=u.now(),latest=GM_getValue("latest",0),vlist=GM_getValue("vlist",[]);now>latest?(GM_setValue("latest",now+9e4),fetch(`${pod.home}/api/vlike?version=${pod.version}`).then(r=>r.json()).then(d=>{0===d.code&&(vlist=d.data,GM_setValue("vlist",vlist),pod.vli=document.createElement("div"),pod.vli.insertAdjacentHTML("beforeend",'<div style="padding-bottom: 10px">\u4eba\u673a\u9a8c\u8bc1 \u8bf7\u7ed9\u4e0b\u9762\u7684\u4efb\u4e00\u89c6\u9891\u70b9\u8d5e \u5b8c\u6210\u540e\u8fd4\u56de\u6b64\u9875\u9762\u5237\u65b0\u5373\u53ef</div><ul class="vlist"></ul>'),pod.vli.querySelector("ul.vlist").insertAdjacentHTML("afterbegin",u.tpl('<li><a href="https://www.bilibili.com/video/[bvid]" target="_blank" referrerpolicy="no-referrer"><img width="160" src="[pic]@160w_100h_1c.webp" crossorigin="anonymous" referrerpolicy="no-referrer"><div class="title">[title]</div></a></li>',vlist)))})):(pod.vli=document.createElement("div"),pod.vli.insertAdjacentHTML("beforeend",'<div style="padding-bottom: 10px">\u4eba\u673a\u9a8c\u8bc1 \u8bf7\u7ed9\u4e0b\u9762\u7684\u4efb\u4e00\u89c6\u9891\u70b9\u8d5e \u5b8c\u6210\u540e\u8fd4\u56de\u6b64\u9875\u9762\u5237\u65b0\u5373\u53ef</div><ul class="vlist"></ul>'),pod.vli.querySelector("ul.vlist").insertAdjacentHTML("afterbegin",u.tpl('<li><a href="https://www.bilibili.com/video/[bvid]" target="_blank" referrerpolicy="no-referrer"><img width="160" src="[pic]@160w_100h_1c.webp" crossorigin="anonymous" referrerpolicy="no-referrer"><div class="title">[title]</div></a></li>',vlist)))}
